(this.webpackJsonpsav3=this.webpackJsonpsav3||[]).push([[0],{1007:function(e,t){},1098:function(e,t){},1146:function(e,t){},126:function(e,t,n){"use strict";var r={bootstrapUsersGoogleSheetId:"1O4Wutfc34QeBEKIP5X4XtwpmRLOt5ytoDc1qv4nSHIg",starServers:["/dns4/star.sav3.org/tcp/443/wss/p2p-webrtc-star/"],ipnsServer:"https://ipns.sav3.org",urlTimeToLive:864e5};window.config=r,t.a=r},1344:function(e,t,n){"use strict";n.r(t);var r=n(2),a=n(0),s=n(46),i=n.n(s),c=n(21),o=n(62),u=n(1409),l=n(1381),p=n(89),d=n(11),f=n(1392),b=n(1348),h=n(1394),j=n(1395),v=n(260),g=n.n(v),x=n(265),O=n.n(x),m=n(175),y=n.n(m),w=n(262),C=n.n(w),k=n(264),P=n.n(k),S=n(263),I=n.n(S),N=n(261),F=n.n(N),R=n(1393),U=n(1411),B=n(266),A=n.n(B),J=n(1396),M=n(40),T=n(210),z=n.n(T),E=function(e){return z()({},W,e)},W=E({Follow:function(){return"Follow"},Unfollow:function(){return"Unfollow"},"Edit profile":function(){return"Edit profile"},"Display name":function(){return"Display name"},Description:function(){return"Description"},"Thumbnail URL":function(){return"Thumbnail URL"},"Banner URL":function(){return"Banner URL"},Home:function(){return"Home"},Profile:function(){return"Profile"},Search:function(){return"Search"},"Search user ID":function(){return"Search user ID"},Peers:function(){return"Peers"},"Connected peers posts":function(){return"Connected peers posts"},Stats:function(){return"Stats"},"Connected peers stats":function(){return"Connected peers stats"},"Connecting to peers":function(){return"Connecting to peers"},Following:function(){return"Following"},"Not following anyone":function(){return"Not following anyone"},Export:function(){return"Export"},Import:function(){return"Import"},Feed:function(){return"Feed"},"Uncensorable content":function(){return"Uncensorable content"},Post:function(){return"Post"},"Copied to clipboard":function(){return"Copied to clipboard"},Share:function(){return"Share"},"URL expired":function(){return"URL expired"}}),L=n(176);Object(L.b)("es-MX",(function(e,t,n){return[["justo ahora","en un rato"],["hace %s segundos","en %s segundos"],["hace 1 minuto","en 1 minuto"],["hace %s minutos","en %s minutos"],["hace 1 hora","en 1 hora"],["hace %s horas","en %s horas"],["hace 1 d\xeda","en 1 d\xeda"],["hace %s d\xedas","en %s d\xedas"],["hace 1 semana","en 1 semana"],["hace %s semanas","en %s semanas"],["hace 1 mes","en 1 mes"],["hace %s meses","en %s meses"],["hace 1 a\xf1o","en 1 a\xf1o"],["hace %s a\xf1os","en %s a\xf1os"]][t]}));var q=E({Follow:function(){return"Seguir"},Unfollow:function(){return"Dejar de seguir"},"Edit profile":function(){return"Editar perfil"},"Display name":function(){return"Nombre para mostrar"},Description:function(){return"Descripci\xf3n"},"Thumbnail URL":function(){return"URL de miniatura"},"Banner URL":function(){return"URL del banner"},Home:function(){return"Casa"},Profile:function(){return"Perfil"},Search:function(){return"Buscar"},"Search user ID":function(){return"Buscar ID de usuario"},Peers:function(){return"Compa\xf1eros"},"Connected peers posts":function(){return"Publicaciones de compa\xf1eros conectados"},Stats:function(){return"Estadisticas"},"Connected peers stats":function(){return"Estad\xedsticas de compa\xf1eros conectados"},"Connecting to peers":function(){return"Conectando con sus compa\xf1eros"},Following:function(){return"Siguiendo"},"Not following anyone":function(){return"No seguir a nadie"},Export:function(){return"Exportar"},Import:function(){return"Importar"},"Uncensorable content":function(){return"Contenido sin censura"},Post:function(){return"Publicaci\xf3n"}});Object(L.b)("hu",(function(e,t,n){return[["\xe9ppen most","\xe9ppen most"],["%s m\xe1sodperce","%s m\xe1sodpercen bel\xfcl"],["1 perce","1 percen bel\xfcl"],["%s perce","%s percen bel\xfcl"],["1 \xf3r\xe1ja","1 \xf3r\xe1n bel\xfcl"],["%s \xf3r\xe1ja","%s \xf3r\xe1n bel\xfcl"],["1 napja","1 napon bel\xfcl"],["%s napja","%s napon bel\xfcl"],["1 hete","1 h\xe9ten bel\xfcl"],["%s hete","%s h\xe9ten bel\xfcl"],["1 h\xf3napja","1 h\xf3napon bel\xfcl"],["%s h\xf3napja","%s h\xf3napon bel\xfcl"],["1 \xe9ve","1 \xe9ven bel\xfcl"],["%s \xe9ve","%s \xe9ven bel\xfcl"]][t]}));var D=E({Follow:function(){return"K\xf6vet\xe9s"},Unfollow:function(){return"K\xf6vet\xe9s megsz\xfcntet\xe9se"},"Edit profile":function(){return"Profil szerkeszt\xe9se"},"Display name":function(){return"L\xe1that\xf3 n\xe9v"},Description:function(){return"Le\xedr\xe1s"},"Thumbnail URL":function(){return"Profilk\xe9p URL"},"Banner URL":function(){return"Banner URL"},Home:function(){return"Home"},Profile:function(){return"Profil"},Search:function(){return"Keres\xe9s"},"Search user ID":function(){return"Felhaszn\xe1l\xf3 ID keres\xe9se"},Peers:function(){return"Kapcsolatok"},"Connected peers posts":function(){return"Kapcsolatok \xfczenetei"},Stats:function(){return"Statisztik\xe1k"},"Connected peers stats":function(){return"Kapcsolatok statisztik\xe1i"},"Connecting to peers":function(){return"Kapcsol\xf3d\xe1s"},Following:function(){return"K\xf6vet\xe9sek"},"Not following anyone":function(){return"Nem k\xf6vet senkit"},Export:function(){return"Export\xe1l\xe1s"},Import:function(){return"Import\xe1l\xe1s"},"Uncensorable content":function(){return"Cenz\xfar\xe1zhatatlan tartalom"}}),K={"en-US":W,"es-MX":q,hu:D};Object.freeze(K);var _=K,Q=Object(a.createContext)({languageCode:"en-US",setLanguageCode:null}),H=function(e){var t="en-US",n=window.navigator.language,s=localStorage.getItem("languageCode")||n||t;_[s]||(console.warn("no available translation for '".concat(s,"'")),s=t);var i=Object(a.useState)(s),c=Object(d.a)(i,2),o=c[0],u=c[1],l={languageCode:o,setLanguageCode:function(e){_[e]?(localStorage.setItem("languageCode",e),u(e)):console.warn("no available translation for '".concat(e,"'"))}},p=e.children;return Object(r.jsx)(Q.Provider,{value:l,children:p})},V=function(){var e=Object(a.useContext)(Q).languageCode;return _[e]},G=n(1),X=n.n(G),Z=n(8),$=n(1413),Y=n(32),ee=n(27),te=n(15),ne=n(125),re=n(99),ae=n(250),se=n(269),ie=n(39),ce=n(83),oe=n(365),ue=n.n(oe),le=n(558),pe=n(7),de=n.n(pe),fe=n(177),be=n(173),he=n.n(be),je=function(){var e,t,n,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=r.name,s=r.maxSize;de()("string"===typeof a,"invalid idb lru cache '".concat(a,"' not a string")),de()("number"===typeof s,"invalid idb lru maxSize '".concat(s,"' not a number"));var i=!1,c=function(){var r=Object(Z.a)(X.a.mark((function r(){var s,c,o,u;return X.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return s=fe.createInstance({name:a}),c=fe.createInstance({name:"_".concat(a)}),r.next=4,s.length();case 4:return o=r.sent,r.next=7,c.length();case 7:u=r.sent,o>u?(t=s,e=c,n=o):(t=c,e=s,n=u),i=!0;case 10:case"end":return r.stop()}}),r)})));return function(){return r.apply(this,arguments)}}();c();var o=function(){var e=Object(Z.a)(X.a.mark((function e(){return X.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!i){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,he()(10);case 4:return e.next=6,o();case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();function u(e,t){return l.apply(this,arguments)}function l(){return(l=Object(Z.a)(X.a.mark((function r(a,i){var c;return X.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,e.setItem(a,i);case 2:if(!(++n>=s)){r.next=11;break}return n=0,c=t,t=e,e=c,r.next=11,e.clear();case 11:case"end":return r.stop()}}),r)})))).apply(this,arguments)}return{has:function(){var n=Object(Z.a)(X.a.mark((function n(r){var a,s;return X.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,o();case 2:return n.next=4,e.getItem(r);case 4:return a=n.sent,n.next=7,t.getItem(r);case 7:return s=n.sent,n.abrupt("return",null!==a&&void 0!==a||null!==s&&void 0!==s);case 9:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}(),remove:function(){var n=Object(Z.a)(X.a.mark((function n(r){return X.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,o();case 2:return n.next=4,e.removeItem(r);case 4:return n.next=6,t.removeItem(r);case 6:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}(),get:function(){var n=Object(Z.a)(X.a.mark((function n(r){var a,s,i;return X.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,o();case 2:return n.next=4,e.getItem(r);case 4:return a=n.sent,n.next=7,t.getItem(r);case 7:if(s=n.sent,null===(i=a)||void 0===a){n.next=11;break}return n.abrupt("return",i);case 11:if(null===(i=s)||void 0===(i=s)){n.next=15;break}return n.next=14,u(r,i);case 14:return n.abrupt("return",i);case 15:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}(),set:function(){var t=Object(Z.a)(X.a.mark((function t(n,r){var a;return X.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,o();case 2:return t.next=4,e.getItem(n);case 4:if(null===(a=t.sent)||void 0===a){t.next=10;break}return t.next=8,e.setItem(n,r);case 8:t.next=12;break;case 10:return t.next=12,u(n,r);case 12:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),clear:function(){var n=Object(Z.a)(X.a.mark((function n(){return X.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,o();case 2:return n.next=4,e.clear();case 4:return n.next=6,t.clear();case 6:case"end":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}}()}};window.IdbLru=je;var ve=je,ge=n(25),xe=n.n(ge),Oe=ve({name:"sdpCache",maxSize:2e3}),me=xe()("sav3:sav3-ipfs:utils:webrtc"),ye=function(e){return function(){var t=Object(Z.a)(X.a.mark((function t(n,r){var a,s;return X.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e(n,r);case 2:return a=t.sent,s=n.getPeerId(),Oe.set(s,a._pc.remoteDescription.sdp),me("outbound webrtc connection",s,a._pc.remoteDescription.sdp),t.abrupt("return",a);case 7:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()},we=function(e){return function(){var t=Object(Z.a)(X.a.mark((function t(n){var r,a;return X.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e(n);case 2:return r=t.sent,a=r.remotePeer.toB58String(),Oe.set(a,n.conn._pc.remoteDescription.sdp),me("inbound webrtc connection",a,n.conn._pc.remoteDescription.sdp),t.abrupt("return",r);case 7:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},Ce=function(){var e=Object(Z.a)(X.a.mark((function e(t){var n,r,a;return X.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return de()(t&&"string"===typeof t,"invalid peer id ".concat(t)),e.next=3,Oe.get(t);case 3:return n=e.sent,de()(n,"no sdp cache for peer id '".concat(t,"'")),r=le.parse(n),a={ip:r.media[0].connection.ip,port:r.media[0].port,protocol:r.media[0].protocol},e.abrupt("return",a);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ke={withWebRtcSdpCache:function(e){var t=e.libp2p.transportManager._transports.get("WebRTCStar")._connect;t=t.bind(e.libp2p.transportManager._transports.get("WebRTCStar")),e.libp2p.transportManager._transports.get("WebRTCStar")._connect=ye(t);var n=e.libp2p.transportManager._transports.get("WebRTCStar")._upgrader.upgradeInbound;return n=n.bind(e.libp2p.transportManager._transports.get("WebRTCStar")._upgrader),e.libp2p.transportManager._transports.get("WebRTCStar")._upgrader.upgradeInbound=we(n),e},sdpCache:Oe,getWebRtcPeerConnectionInfo:Ce},Pe=n(254),Se=new(n.n(Pe).a)({maxSize:1e3}),Ie=xe()("sav3:sav3-ipfs:utils:bitswap"),Ne=function(e){return function(t,n,r){if(!1===r){var a=t,s=n.cid.toString();Se.set(a,s),Ie("bitswapUpdateReceiveCounters",{peerCid:a,blockCid:s})}return e(t,n,r)}},Fe=function(e){var t=e.ipld.bs._bitswap._updateReceiveCounters;return t=t.bind(e.ipld.bs._bitswap),e.ipld.bs._bitswap._updateReceiveCounters=Ne(t),e},Re=n(28),Ue=n.n(Re),Be=n(559),Ae=n(45),Je=n.n(Ae),Me=n(59),Te=n.n(Me),ze=n(87),Ee=n.n(ze),We=n(54),Le=["https://i.imgur.com/iKxWt1c.jpg","https://i.imgur.com/iD4bp6Mb.jpg","https://i.imgur.com/65kSbHTb.jpg","https://i.imgur.com/tNsOG3Bb.jpg","https://i.imgur.com/qiQHwHbb.jpg","https://i.imgur.com/txRRZpd.jpeg"],qe=["https://i.imgur.com/ImQWjja.jpeg","https://i.imgur.com/txRRZpd.jpeg","https://i.imgur.com/2LwSsSu.gif","https://i.imgur.com/gpKZaRK.jpeg"],De=["https://i.imgur.com/qiQHwHb.mp4","i.imgur.com/ImQWjja.jpeg","http://i.imgur.com/txRRZpd.jpeg","https://i.imgur.com/2LwSsSu.gif","i.imgur.com/gpKZaRK.jpeg"],Ke=["Jimmy Nguyen","Shadders","WallStreet5","Joshua Henslee","John M"],_e=["Founder and CEO of XYZ.  Architect of the XYZ Protocol","I like Networks & Social Paradigm Shifts.","Spanish IT Raspberry Pi 4 + Python #BigData #Hacking #Cybersecurity #IoT #IPv6","U mad bro?","Praesentpellentesquetellussitametnuncfaucibus,sitametconvallissemporta.Sedmetudui,luctusavolutpatid,malesuadaadui."],Qe=["https://mystartup.com","mystartup.com","https://twitter.com/crypto","https://t.me/sav3org"],He=["Lorem ipsum dolor sit amet, consectetur adipiscing elit.","Duis turpis nibh, feugiat gravida venenatis vitae, eleifend eu enim. Ut in luctus lorem. Vivamus lectus nunc, cursus eget eleifend ut, luctus et nibh.","Suspendisse","Praesent pellentesque tellus sit amet nunc faucibus, sit amet convallis sem porta. Sed metus dui, luctus a volutpat id, malesuada a dui.","https://verylonglink.com/veryveryveryveryveryveryveryveryveryvery-long-link Praesent pellentesque tellus sit amet nunc faucibus, sit amet convallis sem porta. Sed metus dui, luctus a volutpat id, malesuada a dui","Nullam egestas eget augue id dapibus","Praesentpellentesquetellussitametnuncfaucibus,sitametconvallissemporta.Sedmetudui,luctusavolutpatid,malesuadaadui."],Ve=0,Ge=function(e){var t=Math.floor(Math.random()*e.length);return t+=Ve++,e[t%=e.length]},Xe=function(e){window.sav3IpfsTest={},window.sav3IpfsTest.add=Object(Z.a)(X.a.mark((function t(){var n,r;return X.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n={content:"hello world "+Math.random()},t.next=3,e.ipfs.add(n);case 3:r=t.sent,console.log(r);case 5:case"end":return t.stop()}}),t)}))),window.sav3IpfsTest.get=function(){var t=Object(Z.a)(X.a.mark((function t(n){var r,a,s,i,c,o,u,l,p,d,f,b,h,j,v;return X.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:r=!0,a=!1,t.prev=2,i=Object(We.a)(e.ipfs.get(n));case 4:return t.next=6,i.next();case 6:return c=t.sent,r=c.done,t.next=10,c.value;case 10:if(o=t.sent,r){t.next=54;break}if(u=o,console.log(u.path),u.content){t.next=16;break}return t.abrupt("continue",51);case 16:l=[],p=!0,d=!1,t.prev=19,b=Object(We.a)(u.content);case 21:return t.next=23,b.next();case 23:return h=t.sent,p=h.done,t.next=27,h.value;case 27:if(j=t.sent,p){t.next=34;break}v=j,l.push(v);case 31:p=!0,t.next=21;break;case 34:t.next=40;break;case 36:t.prev=36,t.t0=t.catch(19),d=!0,f=t.t0;case 40:if(t.prev=40,t.prev=41,p||null==b.return){t.next=45;break}return t.next=45,b.return();case 45:if(t.prev=45,!d){t.next=48;break}throw f;case 48:return t.finish(45);case 49:return t.finish(40);case 50:console.log(l.toString());case 51:r=!0,t.next=4;break;case 54:t.next=60;break;case 56:t.prev=56,t.t1=t.catch(2),a=!0,s=t.t1;case 60:if(t.prev=60,t.prev=61,r||null==i.return){t.next=65;break}return t.next=65,i.return();case 65:if(t.prev=65,!a){t.next=68;break}throw s;case 68:return t.finish(65);case 69:return t.finish(60);case 70:case"end":return t.stop()}}),t,null,[[2,56,60,70],[19,36,40,50],[41,,45,49],[61,,65,69]])})));return function(e){return t.apply(this,arguments)}}(),window.sav3IpfsTest.addresses=Object(Z.a)(X.a.mark((function t(){var n,r,a,s,i;return X.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.ipfs.swarm.addrs();case 2:for(r in n=t.sent){a=Object(te.a)(n[r].addrs);try{for(a.s();!(s=a.n()).done;)(i=s.value).string=i.toString()}catch(c){a.e(c)}finally{a.f()}}console.log(n);case 5:case"end":return t.stop()}}),t)}))),window.sav3IpfsTest.peers=Object(Z.a)(X.a.mark((function t(){var n,r,a,s;return X.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.ipfs.swarm.peers();case 2:n=t.sent,r=Object(te.a)(n);try{for(r.s();!(a=r.n()).done;)(s=a.value).addrString=s.addr.toString()}catch(i){r.e(i)}finally{r.f()}console.log(n);case 6:case"end":return t.stop()}}),t)}))),window.sav3IpfsTest.editProfile=Object(Z.a)(X.a.mark((function t(){var n;return X.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=Math.random()>.5?Ge(Qe):"",t.next=3,e.editUserProfile({displayName:Ge(Ke),description:"".concat(Ge(_e).substring(0,100)," ").concat(n),thumbnailUrl:Ge(Le),bannerUrl:Ge(qe)});case 3:case"end":return t.stop()}}),t)}))),window.sav3IpfsTest.publishPosts=Object(Z.a)(X.a.mark((function t(){var n,r,a,s,i,c=arguments;return X.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=c.length>0&&void 0!==c[0]?c[0]:5;case 1:if(!n--){t.next=11;break}return a=Math.random()>.5?Ge(De):"",s=void 0,i=void 0,3===n&&(s=r),1===n&&(i=r),t.next=8,e.publishPost({quotedPostCid:s,parentPostCid:i,content:"".concat(Ge(He).substring(0,100)," ").concat(a)});case 8:r=t.sent,t.next=1;break;case 11:case"end":return t.stop()}}),t)}))),window.sav3IpfsTest.editProfileAndPublishPosts=function(){var e=Object(Z.a)(X.a.mark((function e(t){return X.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,window.sav3IpfsTest.editProfile();case 2:return e.next=4,window.sav3IpfsTest.publishPosts(t);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),window.sav3IpfsTest.importExport=function(){var t=Object(Z.a)(X.a.mark((function t(n){var r,a,s,i,c,o,u,l,p,d;return X.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.waitForReady();case 2:return t.next=4,e.ipfs.id();case 4:return r=t.sent,a=r.id,s=r.publicKey,t.next=9,e.getOwnPeerCid();case 9:return i=t.sent,t.next=12,e.getPrivateKey();case 12:return c=t.sent,t.next=15,e.setPrivateKey(n||c);case 15:return t.next=17,e.waitForReady();case 17:return t.next=19,e.ipfs.id();case 19:return o=t.sent,u=o.id,l=o.publicKey,t.next=24,e.getOwnPeerCid();case 24:return p=t.sent,t.next=27,e.getPrivateKey();case 27:d=t.sent,console.log("oldCid",a),console.log("newCid",u),console.log("oldPeerCid",i),console.log("newPeerCid",p),console.log("oldPublicKey",s),console.log("newPublicKey",l),console.log("oldPrivateKey",c),console.log("newPrivateKey",d);case 36:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),window.sav3IpfsTest.getPreviousPostCids=function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(var a=function(){var t=i[s];Object(Z.a)(X.a.mark((function n(){var r,a,s,i,c,o,u,l;return X.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:r=1,a=!0,s=!1,n.prev=3,c=Object(We.a)(e.getPreviousPostCids(t));case 5:return n.next=7,c.next();case 7:return o=n.sent,a=o.done,n.next=11,o.value;case 11:if(u=n.sent,a){n.next=18;break}l=u,console.log("getPreviousPostCids",t,r++,l);case 15:a=!0,n.next=5;break;case 18:n.next=24;break;case 20:n.prev=20,n.t0=n.catch(3),s=!0,i=n.t0;case 24:if(n.prev=24,n.prev=25,a||null==c.return){n.next=29;break}return n.next=29,c.return();case 29:if(n.prev=29,!s){n.next=32;break}throw i;case 32:return n.finish(29);case 33:return n.finish(24);case 34:case"end":return n.stop()}}),n,null,[[3,20,24,34],[25,,29,33]])})))()},s=0,i=n;s<i.length;s++)a()}},Ze=n(31),$e=n.n(Ze),Ye=n(126),et=xe()("sav3:sav3-ipfs:utils:post-reply"),tt=ve({name:"postReplyCache",maxSize:2e3}),nt=function(){var e=Object(Z.a)(X.a.mark((function e(){var t,n,r,a,s,i=arguments;return X.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=i.length>0&&void 0!==i[0]?i[0]:{},n=t.cid,r=t.parentPostCid,de()(n&&"string"===typeof n,"postReplyUtils.cachePostReplyCid cid '".concat(n,"' not a string")),de()(r&&"string"===typeof r,"postReplyUtils.cachePostReplyCid parentPostCid '".concat(r,"' not a string")),e.next=5,tt.get(r);case 5:return a=e.sent,s={},a&&(s=JSON.parse(a)),s[n]=!0,et("cachePostReplyCid",{cid:n,parentPostCid:r,postReplyCids:s,res:a}),e.next=12,tt.set(r,JSON.stringify(s));case 12:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),rt=function(){var e=Object(Z.a)(X.a.mark((function e(t){var n,r;return X.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return de()(t&&"string"===typeof t,"postReplyUtils.getPostReplyCids postCid '".concat(t,"' not a string")),e.next=3,tt.get(t);case 3:return n=e.sent,r=[],n&&(r=Object.keys(JSON.parse(n))),et("getPostReplyCids",{postCid:t,postReplyCids:r,res:n}),e.abrupt("return",r);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),at={postReplyCache:tt,cachePostReplyCid:nt,getPostReplyCids:rt},st=xe()("sav3:sav3-ipfs:utils:post-quote"),it=ve({name:"postQuoteCache",maxSize:2e3}),ct=function(){var e=Object(Z.a)(X.a.mark((function e(){var t,n,r,a,s,i=arguments;return X.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=i.length>0&&void 0!==i[0]?i[0]:{},n=t.cid,r=t.quotedPostCid,de()(n&&"string"===typeof n,"postQuoteUtils.cachePostQuoteCid cid '".concat(n,"' not a string")),de()(r&&"string"===typeof r,"postQuoteUtils.cachePostQuoteCid quotedPostCid '".concat(r,"' not a string")),e.next=5,it.get(r);case 5:return a=e.sent,s={},a&&(s=JSON.parse(a)),s[n]=!0,st("cachePostQuoteCid",{cid:n,quotedPostCid:r,postQuoteCids:s,res:a}),e.next=12,it.set(r,JSON.stringify(s));case 12:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),ot=function(){var e=Object(Z.a)(X.a.mark((function e(t){var n,r;return X.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return de()(t&&"string"===typeof t,"postQuoteUtils.getPostQuoteCids postCid '".concat(t,"' not a string")),e.next=3,it.get(t);case 3:return n=e.sent,r=[],n&&(r=Object.keys(JSON.parse(n))),st("getPostQuoteCids",{postCid:t,postQuoteCids:r,res:n}),e.abrupt("return",r);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ut={postQuoteCache:it,cachePostQuoteCid:ct,getPostQuoteCids:ot},lt=function(e){de()(e&&("string"===typeof e||"object"===typeof e),"invalid data to serialize '".concat(e,"' not a string or object"))},pt=function(e){if("string"===typeof e)try{e=JSON.parse(e)}catch(t){throw Error("invalid data to serialize '".concat(e,"' not valid json: ").concat(t.message))}return e},dt={deserializePost:function(e){return lt(e),e=pt(e),de()(e.usr&&"string"===typeof e.usr,"invalid post '".concat(JSON.stringify(e),"' post.usr not a string")),de()(e.tmp&&"number"===typeof e.tmp,"invalid post '".concat(JSON.stringify(e),"' post.tmp not a number")),{userCid:e.usr,contentCid:e.cnt,timestamp:e.tmp,quotedPostCid:e.quo,parentPostCid:e.par,previousPostCid:e.pre}},deserializeProfile:function(e){return lt(e),{diplayNameCid:(e=pt(e)).nam,descriptionCid:e.des,thumbnailUrlCid:e.thu,bannerUrlCid:e.ban}},deserializeUserIpnsContent:function(e){return lt(e),{profileCid:(e=pt(e)).pro,lastPostCid:e.las,followingCid:e.fol}},serializePost:function(e){de()(e&&"object"===typeof e,"invalid post '".concat(JSON.stringify(e),"' post not an object")),de()(e.userCid&&"string"===typeof e.userCid,"invalid post '".concat(JSON.stringify(e),"' post.userCid not a string")),de()(e.timestamp&&"number"===typeof e.timestamp,"invalid post '".concat(JSON.stringify(e),"' post.timestamp not a number")),de()(void 0===e.contentCid||e.contentCid&&"string"===typeof e.contentCid,"invalid post '".concat(JSON.stringify(e),"' post.contentCid not a string")),de()(void 0===e.parentPostCid||e.parentPostCid&&"string"===typeof e.parentPostCid,"invalid post '".concat(JSON.stringify(e),"' post.parentPostCid not a string")),de()(void 0===e.previousPostCid||e.previousPostCid&&"string"===typeof e.previousPostCid,"invalid post '".concat(JSON.stringify(e),"' post.previousPostCid not a string"));var t={usr:e.userCid,tmp:e.timestamp};return e.contentCid&&(t.cnt=e.contentCid),e.parentPostCid&&(t.par=e.parentPostCid),e.previousPostCid&&(t.pre=e.previousPostCid),e.quotedPostCid&&(t.quo=e.quotedPostCid),JSON.stringify(t)},serializeProfile:function(e){de()(e&&"object"===typeof e,"invalid profile '".concat(JSON.stringify(e),"' profile not an object"));var t={};return e.diplayNameCid&&(t.nam=e.diplayNameCid),e.descriptionCid&&(t.des=e.descriptionCid),e.thumbnailUrlCid&&(t.thu=e.thumbnailUrlCid),e.bannerUrlCid&&(t.ban=e.bannerUrlCid),JSON.stringify(t)},serializeUserIpnsContent:function(e){de()(e&&"object"===typeof e,"invalid userIpnsContent '".concat(JSON.stringify(e),"' userIpnsContent not an object"));var t={};return e.profileCid&&(t.pro=e.profileCid),e.lastPostCid&&(t.las=e.lastPostCid),e.followingCid&&(t.fol=e.followingCid),JSON.stringify(t)}},ft=xe()("sav3:sav3-ipfs:index"),bt=new(function(e){Object(ae.a)(n,e);var t=Object(se.a)(n);function n(){var e;return Object(ne.a)(this,n),(e=t.call(this)).ipfs=null,e.ipnsClient=null,e._initIpfs().catch(console.error),e}return Object(re.a)(n,[{key:"_initIpfs",value:function(){var e=Object(Z.a)(X.a.mark((function e(){var t,n,r,a,s=this,i=arguments;return X.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=i.length>0&&void 0!==i[0]?i[0]:{},n=t.privateKey,r={preload:{enabled:!1},config:{Bootstrap:[],Addresses:{Delegates:[],Swarm:Ye.a.starServers}}},n&&(r.config.Identity={PrivKey:n}),ft("_initIpfs",{ipfsOptions:r}),e.next=7,ue.a.create(r);case 7:a=e.sent,this.ipfs=ke.withWebRtcSdpCache(a),this.ipfs=Fe(a),this.ipnsClient=Object(Be.a)({ipfs:a}),this.ipnsClient.on("publish",(function(e,t){s.emit("publish",e,t)})),window.ipfs=this.ipfs,this.ipfs.libp2p.on("peer:discovery",(function(e){ft("discovered",e)})),this.ipfs.libp2p.on("peer:connect",(function(e){ft("connected",e),s.ipfs.swarm.peers().then((function(e){return ft("current peers connected: ",e)}))})),this.setMaxListeners(100);case 16:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getPeersStats",value:function(){var e=Object(Z.a)(X.a.mark((function e(){var t,n,r,a,s;return X.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.waitForReady();case 2:return t=[],e.next=5,this.getPeersCids();case 5:n=e.sent,r=Object(te.a)(n),e.prev=7,r.s();case 9:if((a=r.n()).done){e.next=18;break}return s=a.value,e.t0=t,e.next=14,this.getPeerStats(s);case 14:e.t1=e.sent,e.t0.push.call(e.t0,e.t1);case 16:e.next=9;break;case 18:e.next=23;break;case 20:e.prev=20,e.t2=e.catch(7),r.e(e.t2);case 23:return e.prev=23,r.f(),e.finish(23);case 26:return ft("getPeersStats",{peersStats:t}),e.abrupt("return",t);case 28:case"end":return e.stop()}}),e,this,[[7,20,23,26]])})));return function(){return e.apply(this,arguments)}}()},{key:"getPeerStats",value:function(){var e=Object(Z.a)(X.a.mark((function e(t){var n,r,a,s,i,c,o,u,l;return X.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.waitForReady();case 2:return de()("string"===typeof t,"sav3Ipfs.getPeerStats peerId '".concat(t,"' not a string")),n=this.ipfs.libp2p.metrics,e.prev=4,e.next=7,ke.getWebRtcPeerConnectionInfo(t);case 7:i=e.sent,r=i.ip,a=i.port,s=i.protocol,e.next=15;break;case 13:e.prev=13,e.t0=e.catch(4);case 15:return c=n.forPeer(Ue.a.createFromCID(t)).toJSON(),o=Number(c.dataReceived),u=Number(c.dataSent),l={peerCid:t,ip:r,port:a,protocol:s,dataReceived:o,dataSent:u},e.abrupt("return",l);case 20:case"end":return e.stop()}}),e,this,[[4,13]])})));return function(t){return e.apply(this,arguments)}}()},{key:"getPeersCids",value:function(){var e=Object(Z.a)(X.a.mark((function e(){var t,n,r,a,s,i,c;return X.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.waitForReady();case 2:return e.next=4,this.ipfs.swarm.peers();case 4:t=e.sent,n=new Set,r=[],a=Object(te.a)(t),e.prev=8,a.s();case 10:if((s=a.n()).done){e.next=19;break}if(i=s.value,c=i.peer,!n.has(c)){e.next=15;break}return e.abrupt("continue",17);case 15:n.add(c),r.push(c);case 17:e.next=10;break;case 19:e.next=24;break;case 21:e.prev=21,e.t0=e.catch(8),a.e(e.t0);case 24:return e.prev=24,a.f(),e.finish(24);case 27:return e.abrupt("return",r);case 28:case"end":return e.stop()}}),e,this,[[8,21,24,27]])})));return function(){return e.apply(this,arguments)}}()},{key:"getPrivateKey",value:function(){var e=Object(Z.a)(X.a.mark((function e(){var t,n;return X.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.waitForReady();case 2:return e.next=4,this.ipfs.key.export("self","password");case 4:return t=e.sent,e.next=7,Ee.a.keys.import(t,"password");case 7:return n=e.sent,e.abrupt("return",$e()(n.bytes,"base64"));case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"setPrivateKey",value:function(){var e=Object(Z.a)(X.a.mark((function e(t){var n;return X.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return de()(t&&"string"===typeof t,"sav3Ipfs.setPrivateKey base64PrivateKey '".concat(t,"' not a string")),n=this.ipfs,delete this.ipfs,e.next=5,n.stop();case 5:return e.next=7,this._initIpfs({privateKey:t});case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getOwnPeerCid",value:function(){var e=Object(Z.a)(X.a.mark((function e(){return X.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.waitForReady();case 2:return e.next=4,bt.ipfs.id();case 4:return e.abrupt("return",e.sent.id);case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getOwnUserCid",value:function(){var e=Object(Z.a)(X.a.mark((function e(){return X.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.waitForReady();case 2:return e.next=4,bt.ipfs.id();case 4:return e.abrupt("return",e.sent.id);case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getOwnIpnsRecord",value:function(){var e=Object(Z.a)(X.a.mark((function e(){var t,n,r,a;return X.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.waitForReady();case 2:return e.next=4,bt.getOwnPeerCid();case 4:return t=e.sent,n=Ue.a.createFromCID(t),e.next=8,this.ipfs.libp2p.datastore.get(Te.a.getLocalKey(n.id));case 8:return r=e.sent,a=Te.a.unmarshal(r),e.abrupt("return",a);case 11:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"setOwnIpnsRecord",value:function(){var e=Object(Z.a)(X.a.mark((function e(){var t,n,r,a,s,i,c,o,u,l,p=arguments;return X.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=p.length>0&&void 0!==p[0]?p[0]:{},n=t.value,r=t.sequence,e.next=3,this.waitForReady();case 3:return de()(n&&"string"===typeof n,"sav3Ipfs.setOwnIpnsRecord value '".concat(n,"' not a string")),de()("number"===typeof r,"sav3Ipfs.setOwnIpnsRecord sequence '".concat(r,"' not a number")),n.startsWith("/ipfs/")||(n="/ipfs/".concat(n)),a=31536e7,e.next=9,this.ipfs.key.export("self","password");case 9:return s=e.sent,e.next=12,Ee.a.keys.import(s,"password");case 12:return i=e.sent,e.next=15,Te.a.create(i,n,r,a);case 15:return c=e.sent,o=Te.a.marshal(c),e.next=19,bt.getOwnPeerCid();case 19:return u=e.sent,l=Ue.a.createFromCID(u),e.next=23,this.ipfs.libp2p.datastore.put(Te.a.getLocalKey(l.id),o);case 23:return e.next=25,this.ipfs.name.resolve(u);case 25:return e.abrupt("return",c);case 26:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getIpfsContent",value:function(){var e=Object(Z.a)(X.a.mark((function e(t){var n,r,a;return X.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.waitForReady();case 2:return de()(t&&"string"===typeof t,"sav3Ipfs.getIpfsContent cid '".concat(t,"' not a string")),e.next=5,this.ipfs.get(t).next();case 5:if(!(n=e.sent.value).content){e.next=11;break}return e.next=9,n.content.next();case 9:a=e.sent,r=a&&a.value&&a.value.toString();case 11:return ft("getIpfsContent",{cid:t,file:n,content:r}),e.abrupt("return",r);case 13:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getUserIpnsContent",value:function(){var e=Object(Z.a)(X.a.mark((function e(t){return X.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.waitForReady();case 2:return de()(t&&"string"===typeof t,"sav3Ipfs.getUserIpnsContent userIpnsContentCid '".concat(t,"' not a string")),e.t0=dt,e.next=6,this.getIpfsContent(t);case 6:return e.t1=e.sent,e.abrupt("return",e.t0.deserializeUserIpnsContent.call(e.t0,e.t1));case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getOwnUserIpnsContent",value:function(){var e=Object(Z.a)(X.a.mark((function e(){var t,n,r;return X.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.waitForReady();case 2:return e.next=4,this.getOwnIpnsRecord();case 4:return t=e.sent,n=t.value.toString(),e.next=8,this.getIpfsContent(n);case 8:if(r=e.sent,ft("getOwnUserIpnsContent",{ownIpfsValue:n,lastIpnsContent:r}),r){e.next=12;break}return e.abrupt("return",{});case 12:return e.abrupt("return",dt.deserializeUserIpnsContent(r));case 13:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"subscribeToIpnsPath",value:function(){var e=Object(Z.a)(X.a.mark((function e(t){var n;return X.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return de()(t&&"string"===typeof t,"sav3Ipfs.subscribeToIpnsPath ipnsPath '".concat(t,"' not a string")),e.next=3,this.waitForReady();case 3:return e.next=5,this.ipnsClient.subscribe([t]);case 5:return n=e.sent,e.abrupt("return",n[0]);case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"subscribeToIpnsPaths",value:function(){var e=Object(Z.a)(X.a.mark((function e(t){var n,r,a,s;return X.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:de()(Array.isArray(t),"sav3Ipfs.subscribeToIpnsPaths ipnsPaths '".concat(t,"' not an array")),n=Object(te.a)(t);try{for(n.s();!(r=n.n()).done;)a=r.value,de()(a&&"string"===typeof a,"sav3Ipfs.subscribeToIpnsPaths ipnsPaths '".concat(JSON.stringify(t),"' contains non string"))}catch(i){n.e(i)}finally{n.f()}return e.next=5,this.waitForReady();case 5:return e.next=7,this.ipnsClient.subscribe(t);case 7:return s=e.sent,e.abrupt("return",s);case 9:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"publishPost",value:function(){var e=Object(Z.a)(X.a.mark((function e(){var t,n,r,a,s,i,c,o,u,l=arguments;return X.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=l.length>0&&void 0!==l[0]?l[0]:{},n=t.content,r=t.parentPostCid,a=t.quotedPostCid,e.next=3,this.waitForReady();case 3:return de()(n||a,"sav3Ipfs.publishPost content '".concat(n,"' is empty, quotedPostCid '").concat(a,"'")),de()(!n||"string"===typeof n,"sav3Ipfs.publishPost content '".concat(n,"' not a string")),de()(!n||n.length<=140,"sav3Ipfs.publishPost content '".concat(n,"' longer than 140 chars")),de()(!r||"string"===typeof r,"sav3Ipfs.publishPost parentPostCid '".concat(r,"' not a string")),de()(!a||"string"===typeof a,"sav3Ipfs.publishPost quotedPostCid '".concat(a,"' not a string")),de()(!1===Boolean(r&&a),"sav3Ipfs.publishPost cannot have both parentPostCid '".concat(r,"' and quotedPostCid '").concat(a,"'")),e.next=11,this.getOwnUserIpnsContent();case 11:return s=e.sent,(i={}).quotedPostCid=a,i.parentPostCid=r,i.previousPostCid=s.lastPostCid,i.timestamp=Math.round(Date.now()/1e3),e.next=19,this.ipfs.id();case 19:if(i.userCid=e.sent.id,!n){e.next=24;break}return e.next=23,this.ipfs.add(n);case 23:i.contentCid=e.sent.cid.toString();case 24:return e.next=26,this.ipfs.add(dt.serializePost(i));case 26:return c=e.sent.cid.toString(),o=Object(ee.a)(Object(ee.a)({},s),{},{lastPostCid:c}),e.next=30,this.ipfs.add(dt.serializeUserIpnsContent(o));case 30:return u=e.sent.cid.toString(),e.next=33,this.publishIpnsRecord(u);case 33:if(ft("publishPost",{newIpnsContentCid:u,newPost:i,newIpnsContent:o,ipnsContent:s,newPostCid:c,parentPostCid:r,quotedPostCid:a}),!r){e.next=37;break}return e.next=37,at.cachePostReplyCid({cid:c,parentPostCid:r});case 37:if(!a){e.next=40;break}return e.next=40,ut.cachePostQuoteCid({cid:c,quotedPostCid:a});case 40:return e.abrupt("return",c);case 41:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"setFollowing",value:function(){var e=Object(Z.a)(X.a.mark((function e(t){var n,r,a,s;return X.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.waitForReady();case 2:return de()(Array.isArray(t),"sav3Ipfs.setFollowing userCids '".concat(t,"' not an array")),t=Object(Y.a)(t).sort(),e.next=6,this.getOwnUserIpnsContent();case 6:return n=e.sent,e.next=9,this.ipfs.add(JSON.stringify(t));case 9:if(r=e.sent.cid.toString(),n.followingCid!==r){e.next=13;break}return ft("setFollowing duplicate following cid",{userCids:t}),e.abrupt("return");case 13:return a=Object(ee.a)(Object(ee.a)({},n),{},{followingCid:r}),e.next=16,this.ipfs.add(dt.serializeUserIpnsContent(a));case 16:return s=e.sent.cid.toString(),e.next=19,this.publishIpnsRecord(s);case 19:return ft("setFollowing",{newIpnsContentCid:s,userCids:t,followingCid:r,newIpnsContent:a,ipnsContent:n}),e.abrupt("return",r);case 21:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getUserFollowing",value:function(){var e=Object(Z.a)(X.a.mark((function e(t){var n,r,a,s,i;return X.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.waitForReady();case 2:return de()(t&&"string"===typeof t,"sav3Ipfs.getUserFollowing userCid '".concat(t,"' not a string")),n=[],e.next=6,this.ipnsClient.subscribe([t]);case 6:if(r=e.sent,a=Object(d.a)(r,1),!(s=a[0])){e.next=19;break}return e.next=12,this.getUserIpnsContent(s);case 12:if(!(i=e.sent).followingCid){e.next=19;break}return e.t0=JSON,e.next=17,this.getIpfsContent(i.followingCid);case 17:e.t1=e.sent,n=e.t0.parse.call(e.t0,e.t1);case 19:return ft("getUserFollowing",{userCid:t,following:n,ipnsValue:s}),e.abrupt("return",n);case 21:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"publishIpnsRecord",value:function(){var e=Object(Z.a)(X.a.mark((function e(t){var n;return X.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.waitForReady();case 2:return de()("string"===typeof t,"sav3Ipfs.publishIpnsRecord '".concat(t,"' not a string")),e.next=5,this.getOwnIpnsRecordSequence();case 5:return e.t0=e.sent,n=e.t0+1,e.next=9,this.ipnsClient.publish({value:t,sequence:n});case 9:return e.next=11,this.setOwnIpnsRecord({value:t,sequence:n});case 11:ft("publishIpnsRecord",{newIpnsContentCid:t,sequence:n});case 12:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"editUserProfile",value:function(){var e=Object(Z.a)(X.a.mark((function e(){var t,n,r,a,s,i,c,o,u,l=arguments;return X.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=l.length>0&&void 0!==l[0]?l[0]:{},n=t.displayName,r=t.description,a=t.thumbnailUrl,s=t.bannerUrl,e.next=3,this.waitForReady();case 3:if(i={},!n){e.next=10;break}return de()("string"===typeof n,"display name not a string"),de()(n.length<=50,"display name '".concat(n,"' longer than 50 chars")),e.next=9,this.ipfs.add(n);case 9:i.diplayNameCid=e.sent.cid.toString();case 10:if(!r){e.next=16;break}return de()("string"===typeof r,"description not a string"),de()(r.length<=140,"description '".concat(r,"' longer than 140 chars")),e.next=15,this.ipfs.add(r);case 15:i.descriptionCid=e.sent.cid.toString();case 16:if(!a){e.next=24;break}return de()("string"===typeof a,"thumbnail url not a string"),de()(a.startsWith("https://"),"thumbnail url '".concat(a,"' does not start with https://")),de()(a.replace(/[#?].*/,"").match(/\.(jpeg|jpg|png|gif|mp4|webm)$/),"thumbnail url '".concat(a,"' does not end with jpeg|jpg|png|gif|mp4|webm")),de()(a.length<=140,"thumbnail url '".concat(a,"' longer than 140 chars")),e.next=23,this.ipfs.add(a);case 23:i.thumbnailUrlCid=e.sent.cid.toString();case 24:if(!s){e.next=32;break}return de()("string"===typeof s,"banner url not a string"),de()(s.startsWith("https://"),"banner url '".concat(s,"' does not start with https://")),de()(s.replace(/[#?].*/,"").match(/\.(jpeg|jpg|png|gif|mp4|webm)$/),"banner url '".concat(s,"' does not end with jpeg|jpg|png|gif|mp4|webm")),de()(s.length<=140,"banner url '".concat(s,"' longer than 140 chars")),e.next=31,this.ipfs.add(s);case 31:i.bannerUrlCid=e.sent.cid.toString();case 32:return e.next=34,this.ipfs.add(dt.serializeProfile(i));case 34:return c=e.sent.cid.toString(),e.next=37,this.getOwnUserIpnsContent();case 37:return(o=e.sent).profileCid=c,e.next=41,this.ipfs.add(dt.serializeUserIpnsContent(o));case 41:return u=e.sent.cid.toString(),e.next=44,this.publishIpnsRecord(u);case 44:return ft("editProfile",{displayName:n,description:r,thumbnailUrl:a,bannerUrl:s,ipnsContent:o,profile:i,profileCid:c,newIpnsContentCid:u}),e.abrupt("return",c);case 46:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getUserProfile",value:function(){var e=Object(Z.a)(X.a.mark((function e(t){var n,r;return X.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.waitForReady();case 2:return de()("string"===typeof t,"sav3Ipfs.getUserProfile profileCid '".concat(t,"' not a string")),e.t0=dt,e.next=6,this.getIpfsContent(t);case 6:if(e.t1=e.sent,n=e.t0.deserializeProfile.call(e.t0,e.t1),r={},!n.diplayNameCid){e.next=13;break}return e.next=12,this.getIpfsContent(n.diplayNameCid);case 12:r.displayName=e.sent;case 13:if(!n.descriptionCid){e.next=17;break}return e.next=16,this.getIpfsContent(n.descriptionCid);case 16:r.description=e.sent;case 17:if(!n.thumbnailUrlCid){e.next=21;break}return e.next=20,this.getIpfsContent(n.thumbnailUrlCid);case 20:r.thumbnailUrl=e.sent;case 21:if(!n.bannerUrlCid){e.next=25;break}return e.next=24,this.getIpfsContent(n.bannerUrlCid);case 24:r.bannerUrl=e.sent;case 25:return ft("getUserProfile",{profileCid:t,profileCids:n,profile:r}),e.abrupt("return",r);case 27:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getOwnIpnsRecordSequence",value:function(){var e=Object(Z.a)(X.a.mark((function e(){var t,n,r,a,s,i,c;return X.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.waitForReady();case 2:return e.next=4,this.getOwnIpnsRecord();case 4:return t=e.sent,n=t,e.next=8,bt.getOwnPeerCid();case 8:return r=e.sent,e.next=11,this.ipnsClient.getRecords([r]);case 11:if(a=e.sent,s=Object(d.a)(a,1),i=s[0],c=i&&i.sequence||0,!(n>c)){e.next=19;break}return e.abrupt("return",n);case 19:return e.abrupt("return",c);case 20:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getUserPostsFromLastPostCid",value:function(){var e=Object(Z.a)(X.a.mark((function e(t){var n,r,a;return X.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.waitForReady();case 2:de()(t&&"string"===typeof t,"sav3Ipfs.getUserPostsFromLastPostCid lastPostCid '".concat(t,"' not a string")),n=[],r=5;case 5:if(t){e.next=8;break}return e.abrupt("break",17);case 8:if(!(n.length>=r)){e.next=10;break}return e.abrupt("break",17);case 10:return e.next=12,this.getPost(t);case 12:a=e.sent,t=a.previousPostCid,n.push(a),e.next=5;break;case 17:return ft("getUserPostsFromLastPostCid",{lastPostCid:t,posts:n}),e.abrupt("return",n);case 19:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getPreviousPostCids",value:function(e){var t=this;return Object(ce.a)(X.a.mark((function n(){var r,a,s;return X.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,Object(ie.a)(t.waitForReady());case 2:de()(e&&"string"===typeof e,"sav3Ipfs.getPostCidsFromLastPostCid lastPostCid '".concat(e,"' not a string")),r=e,a=0;case 5:return a++,n.next=9,r;case 9:return n.t0=dt,n.next=12,Object(ie.a)(t.getIpfsContent(r));case 12:if(n.t1=n.sent,s=n.t0.deserializePost.call(n.t0,n.t1),ft("getPreviousPostCids",{lastPostCid:e,previousPostCid:r,post:s,postCount:a}),s.previousPostCid){n.next=17;break}return n.abrupt("return");case 17:r=s.previousPostCid,n.next=5;break;case 20:case"end":return n.stop()}}),n)})))()}},{key:"getPost",value:function(){var e=Object(Z.a)(X.a.mark((function e(t){var n;return X.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.waitForReady();case 2:return de()(t&&"string"===typeof t,"sav3Ipfs.getPost postCid '".concat(t,"' not a string")),ft("getPost",{postCid:t}),e.t0=dt,e.next=7,this.getIpfsContent(t);case 7:if(e.t1=e.sent,(n=e.t0.deserializePost.call(e.t0,e.t1)).cid=t,!n.parentPostCid){e.next=13;break}return e.next=13,at.cachePostReplyCid({cid:n.cid,parentPostCid:n.parentPostCid});case 13:if(!n.quotedPostCid){e.next=16;break}return e.next=16,ut.cachePostQuoteCid({cid:n.cid,quotedPostCid:n.quotedPostCid});case 16:if(!n.contentCid){e.next=20;break}return e.next=19,this.getIpfsContent(n.contentCid);case 19:n.content=e.sent;case 20:return ft("getPost returns",{postCid:t,post:n}),e.abrupt("return",n);case 22:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getPostReplyCids",value:function(){var e=Object(Z.a)(X.a.mark((function e(t){var n;return X.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.waitForReady();case 2:return de()(t&&"string"===typeof t,"sav3Ipfs.getPostReplyCids postCid '".concat(t,"' not a string")),e.next=5,at.getPostReplyCids(t);case 5:return n=e.sent,e.abrupt("return",n);case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getPostQuoteCids",value:function(){var e=Object(Z.a)(X.a.mark((function e(t){var n;return X.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.waitForReady();case 2:return de()(t&&"string"===typeof t,"sav3Ipfs.getPostQuoteCids postCid '".concat(t,"' not a string")),e.next=5,ut.getPostQuoteCids(t);case 5:return n=e.sent,e.abrupt("return",n);case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"isReady",value:function(){return!!this.ipfs}},{key:"waitForReady",value:function(){var e=Object(Z.a)(X.a.mark((function e(){return X.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.ipfs){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,he()(10);case 4:return e.next=6,this.waitForReady();case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),n}(Je.a));window.sav3Ipfs=bt,window.Ipfs=ue.a,Xe(bt);var ht=bt,jt=n(1412),vt=n(1384),gt=n(1388),xt=n(560),Ot=n.n(xt),mt=n(1386),yt=n(1387),wt=n(1383),Ct=Object(l.a)((function(e){return{content:{paddingTop:0,paddingBottom:0,overflow:"hidden"}}}));var kt=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.open,n=e.onClose,a=e.content,s=e.actions,i=Ct(),c=Object(p.a)(),o=Object(wt.a)(c.breakpoints.down("xs"));return Object(r.jsxs)(vt.a,{fullScreen:o,fullWidth:!0,maxWidth:"xs",open:t,onClose:n,children:[Object(r.jsxs)(U.a,{alignItems:"center",display:"flex",px:2,height:c.sav3.topBar.height,children:[Object(r.jsx)(U.a,{flexGrow:1,children:Object(r.jsx)(mt.a,{onClick:n,children:Object(r.jsx)(Ot.a,{})})}),o&&Object(r.jsx)(U.a,{px:1,children:s})]}),Object(r.jsx)(yt.a,{}),Object(r.jsx)(gt.a,{className:i.content,children:a}),!o&&Object(r.jsxs)("div",{children:[Object(r.jsx)(yt.a,{}),Object(r.jsxs)(U.a,{alignItems:"center",display:"flex",px:3,height:c.sav3.topBar.height,children:[Object(r.jsx)(U.a,{flexGrow:1}),Object(r.jsx)(U.a,{children:s})]})]})]})},Pt=xe()("sav3:hooks:use-user-ipns-content"),St=function(e){de()(!e||"string"===typeof e,"invalid ipnsPath '".concat(JSON.stringify(e),"'"));var t=Object(a.useState)(),n=Object(d.a)(t,2),r=n[0],s=n[1];return Pt({ipnsPath:e,userIpnsContent:r}),Object(a.useEffect)((function(){if(r&&s(),e){var t=function(){var t=Object(Z.a)(X.a.mark((function t(n,r){var a;return X.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e===n){t.next=2;break}return t.abrupt("return");case 2:return t.next=4,ht.getUserIpnsContent(r);case 4:a=t.sent,s(a);case 6:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}();return ht.on("publish",t),Object(Z.a)(X.a.mark((function t(){var n,r;return X.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,ht.subscribeToIpnsPath(e);case 2:if(n=t.sent){t.next=6;break}return s(),t.abrupt("return");case 6:return t.next=8,ht.getUserIpnsContent(n);case 8:r=t.sent,s(r);case 10:case"end":return t.stop()}}),t)})))(),function(){ht.off("publish",t)}}}),[e]),r},It=xe()("sav3:hooks:use-user-profile"),Nt=function(e){de()(!e||"string"===typeof e,"invalid userCid '".concat(JSON.stringify(e),"'"));var t={},n=Object(a.useState)(t),r=Object(d.a)(n,2),s=r[0],i=r[1],c=St(e),o=c&&c.profileCid;return It({userIpnsContent:c,userCid:e,profileCid:o,userProfile:s}),Object(a.useEffect)((function(){JSON.stringify(s)!==JSON.stringify(t)&&i(t),o&&"string"===typeof o&&Object(Z.a)(X.a.mark((function e(){var t;return X.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ht.getUserProfile(o);case 2:t=e.sent,i(t);case 4:case"end":return e.stop()}}),e)})))()}),[o]),s},Ft=function(){var e=Object(a.useState)(),t=Object(d.a)(e,2),n=t[0],r=t[1];return Object(a.useEffect)((function(){Object(Z.a)(X.a.mark((function e(){var t;return X.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ht.getOwnUserCid();case 2:t=e.sent,r(t);case 4:case"end":return e.stop()}}),e)})))()}),[]),n},Rt=n(1416),Ut=n(113),Bt=Object(l.a)((function(e){return{errorMessage:{overflow:"hidden"},content:{"& textarea":{overflow:"hidden"},"& fieldset":{border:"none"},marginBottom:e.spacing(1),"& .MuiInputBase-root":{paddingLeft:e.spacing(1)}},avatar:{marginTop:e.spacing(-.25),width:e.spacing(6),height:e.spacing(6),borderWidth:e.sav3.borderWidth,borderStyle:"solid",borderColor:e.sav3.borderColor},userCid:{wordBreak:"break-all"},parentPostLine:{margin:"auto",width:2}}}));function At(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.parentPost,n=Bt();return Object(r.jsxs)(U.a,{display:"flex",mb:1,children:[Object(r.jsxs)(U.a,{pr:1,py:1.5,children:[Object(r.jsx)(Rt.a,{src:t.profile.thumbnailUrl,className:n.avatar}),Object(r.jsx)(yt.a,{className:n.parentPostLine,orientation:"vertical"})]}),Object(r.jsxs)(U.a,{pt:1.5,pl:.5,flexGrow:1,children:[t.profile.displayName&&Object(r.jsx)(Ut.a,{variant:"subtitle2",children:t.profile.displayName}),Object(r.jsx)(Ut.a,{variant:"caption",color:"textSecondary",className:n.userCid,children:t.userCid}),Object(r.jsx)(Ut.a,{variant:"body2",children:t.content})]})]})}var Jt=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.open,n=e.onClose,s=e.parentPost,i=V(),c=Bt(),o=Object(a.useState)(""),u=Object(d.a)(o,2),l=u[0],p=u[1],f=Object(a.useState)(),b=Object(d.a)(f,2),h=b[0],j=b[1],v=Ft(),g=Nt(v),x=function(e){var t=e.target.value;try{t.length>140&&(t=t.subtring(0,140)),p(t)}catch(n){}},O=function(){var e=Object(Z.a)(X.a.mark((function e(){var t;return X.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=s&&s.cid,e.prev=1,e.next=4,ht.publishPost({content:l,parentPostCid:t});case 4:j(null),p(""),n(),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),j(e.t0.message);case 12:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(){return e.apply(this,arguments)}}(),m=Object(r.jsxs)(a.Fragment,{children:[s&&Object(r.jsx)(At,{parentPost:s}),Object(r.jsxs)(U.a,{display:"flex",children:[Object(r.jsx)(U.a,{pr:1,py:1.5,children:Object(r.jsx)(Rt.a,{src:g.thumbnailUrl,className:c.avatar})}),Object(r.jsx)($.a,{autoFocus:!0,className:c.content,onChange:x,margin:"dense",id:"content",placeholder:i["Uncensorable content"](),fullWidth:!0,multiline:!0,rows:4,variant:"outlined",value:l}),h&&Object(r.jsx)(jt.a,{classes:{message:c.errorMessage},severity:"error",children:h})]})]}),y=Object(r.jsx)("div",{children:Object(r.jsx)(R.a,{disableElevation:!0,variant:"contained",onClick:O,color:"primary",children:"SAV3"})});return Object(r.jsx)(kt,{onClose:n,open:t,content:m,actions:y})},Mt=Object(l.a)((function(e){return{logo:{height:"1.1em"},logoButton:{height:"2.2em",width:"2.2em"},createTextButtonBox:Object(c.a)({},e.breakpoints.down("md"),{display:"none"}),createIconButtonBox:Object(c.a)({},e.breakpoints.up("lg"),{display:"none"}),createIconButton:{boxShadow:"none"},text:Object(c.a)({},e.breakpoints.down("md"),{display:"none"}),root:Object(c.a)({position:"fixed",width:"inherit"},e.breakpoints.up("lg"),{paddingLeft:e.spacing(2),paddingRight:e.spacing(2)})}}));function Tt(){var e=Mt(),t=Object(a.useState)(!1),n=Object(d.a)(t,2),s=n[0],i=n[1];return Object(r.jsxs)("div",{children:[Object(r.jsx)(U.a,{my:2,mx:1,alignItems:"center",display:"flex",className:e.createTextButtonBox,onClick:function(){return i(!0)},children:Object(r.jsx)(R.a,{color:"primary",fullWidth:!0,variant:"contained",size:"large",disableElevation:!0,children:"SAV3"})}),Object(r.jsx)(U.a,{my:2,pl:1,alignItems:"center",display:"flex",className:e.createIconButtonBox,onClick:function(){return i(!0)},children:Object(r.jsx)(J.a,{color:"primary",className:e.createIconButton,size:"medium",children:Object(r.jsx)(A.a,{})})}),Object(r.jsx)(Jt,{open:s,onClose:function(){return i(!1)}})]})}var zt=function(){var e=Mt(),t=V();return Object(r.jsx)("div",{className:e.root,children:Object(r.jsxs)(f.a,{children:[Object(r.jsxs)(b.a,{button:!0,component:M.b,to:"/",children:[Object(r.jsx)(h.a,{children:Object(r.jsx)(g.a,{fontSize:"large"})}),Object(r.jsx)(j.a,{primary:t.Home(),className:e.text})]}),Object(r.jsxs)(b.a,{button:!0,component:M.b,to:"/feed",children:[Object(r.jsx)(h.a,{children:Object(r.jsx)(F.a,{fontSize:"large"})}),Object(r.jsx)(j.a,{primary:t.Feed(),className:e.text})]}),Object(r.jsxs)(b.a,{button:!0,component:M.b,to:"/search",children:[Object(r.jsx)(h.a,{children:Object(r.jsx)(y.a,{fontSize:"large"})}),Object(r.jsx)(j.a,{primary:t.Search(),className:e.text})]}),Object(r.jsxs)(b.a,{button:!0,component:M.b,to:"/following",children:[Object(r.jsx)(h.a,{children:Object(r.jsx)(C.a,{fontSize:"large"})}),Object(r.jsx)(j.a,{primary:t.Following(),className:e.text})]}),Object(r.jsxs)(b.a,{button:!0,component:M.b,to:"/peers",children:[Object(r.jsx)(h.a,{children:Object(r.jsx)(I.a,{fontSize:"large"})}),Object(r.jsx)(j.a,{primary:t.Peers(),className:e.text})]}),Object(r.jsxs)(b.a,{button:!0,component:M.b,to:"/stats",children:[Object(r.jsx)(h.a,{children:Object(r.jsx)(P.a,{fontSize:"large"})}),Object(r.jsx)(j.a,{primary:t.Stats(),className:e.text})]}),Object(r.jsxs)(b.a,{button:!0,component:M.b,to:"/profile",children:[Object(r.jsx)(h.a,{children:Object(r.jsx)(O.a,{fontSize:"large"})}),Object(r.jsx)(j.a,{primary:t.Profile(),className:e.text})]}),Object(r.jsx)(Tt,{})]})})},Et=n(1397),Wt=n(1398),Lt=Object(l.a)((function(e){return{menu:{width:"100%",position:"fixed",bottom:0},createIconButtonBox:{right:e.spacing(4),bottom:e.spacing(8)},createIconButton:{}}}));function qt(){var e=Lt(),t=Object(a.useState)(!1),n=Object(d.a)(t,2),s=n[0],i=n[1];return Object(r.jsxs)(U.a,{position:"absolute",className:e.createIconButtonBox,children:[Object(r.jsx)(U.a,{my:2,pl:1,alignItems:"center",display:"flex",className:e.createIconButton,onClick:function(){return i(!0)},children:Object(r.jsx)(J.a,{color:"primary",className:e.createIconButton,size:"large",children:Object(r.jsx)(A.a,{})})}),Object(r.jsx)(Jt,{open:s,onClose:function(){return i(!1)}})]})}var Dt=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.className,n=Lt(),a=Object(o.i)("/:route"),s=a&&a.params&&a.params.route?a.params.route:"home";return Object(r.jsxs)(U.a,{className:t,children:[Object(r.jsxs)(Et.a,{value:s,className:n.menu,children:[Object(r.jsx)(qt,{}),Object(r.jsx)(Wt.a,{component:M.b,to:"/",value:"home",icon:Object(r.jsx)(g.a,{})}),Object(r.jsx)(Wt.a,{component:M.b,to:"/search",value:"search",icon:Object(r.jsx)(y.a,{})}),Object(r.jsx)(Wt.a,{component:M.b,to:"/feed",value:"feed",icon:Object(r.jsx)(F.a,{})}),Object(r.jsx)(Wt.a,{component:M.b,to:"/peers",value:"peers",icon:Object(r.jsx)(I.a,{})})]}),Object(r.jsx)(U.a,{width:0,className:"MuiBottomNavigation-root"})]})},Kt=n(1399),_t=n(569),Qt=n(1415),Ht="rgb(127, 127, 127, 0.05)",Vt={breakpoints:{values:{xs:0,sm:682,md:960,lg:1280,xl:1920}},sav3:{layout:{columns:{left:{width:{md:275,sm:88,xs:68}},middle:{width:{md:600}},right:{width:{lg:350,md:290}}}},borderWidth:1,borderColor:Ht,topBar:{height:54},drawerMenu:{width:280},popoverMenu:{borderRadius:4}},palette:{divider:Ht},shape:{borderRadius:24},overrides:{MuiToolbar:{root:{minHeight:"".concat(54,"px!important")}},MuiDialog:{paper:{margin:0},paperFullWidth:{width:"100%"}},MuiSvgIcon:{fontSizeLarge:{fontSize:"1.8rem"}},MuiFab:{root:{boxShadow:"rgba(101, 119, 134, 0.2) 0px 0px 8px, rgba(101, 119, 134, 0.25) 0px 1px 3px 1px"}},MuiButton:{outlined:{fontWeight:900}}}},Gt=function(e){var t=Object(_t.a)(z()({},Vt,e));return t=Object(Qt.a)(t)},Xt="#857990",Zt={Light:Gt(),Dark:Gt({palette:{type:"dark"}}),"SAV3 Light":Gt({palette:{primary:{light:"#7a7380",main:"#4e4854",dark:"#26212b"},secondary:{main:"#484854"}}}),"SAV3 Dark":Gt({palette:{type:"dark",primary:{light:"#7a7380",main:"#4e4854",dark:"#26212b"},secondary:{main:"#484854"}},overrides:{MuiTypography:{colorPrimary:{color:Xt}},MuiButton:{outlinedPrimary:{color:Xt}}}})};Object.freeze(Zt);var $t=Zt,Yt=Object(a.createContext)({theme:"Light",setTheme:null}),en=function(e){var t=Object(wt.a)("(prefers-color-scheme: dark)")?"Dark":"Light",n=localStorage.getItem("muiTheme")||t;$t[n]||(console.warn("no available theme for '".concat(n,"'")),n=t);var s=Object(a.useState)(n),i=Object(d.a)(s,2),c=i[0],o=i[1],u=$t[c],l={theme:c,setTheme:function(e){$t[e]?(localStorage.setItem("muiTheme",e),o(e)):console.warn("no available theme for '".concat(e,"'"))}},p=e.children;return Object(r.jsx)(Yt.Provider,{value:l,children:Object(r.jsx)(Kt.a,{theme:u,children:p})})},tn=n(1414),nn=n(1400);var rn=function(){var e=Object(a.useContext)(Yt),t=e.theme,n=e.setTheme,s=[];for(var i in $t)s.push(Object(r.jsx)(nn.a,{value:i,children:i},i));return Object(r.jsx)(tn.a,{value:t,onChange:function(e){n(e.target.value)},label:"Theme",variant:"outlined",children:s})};var an=function(){var e=Object(a.useContext)(Q),t=e.languageCode,n=e.setLanguageCode,s=[];for(var i in _)s.push(Object(r.jsx)(nn.a,{value:i,children:i},i));return Object(r.jsx)(tn.a,{value:t,onChange:function(e){n(e.target.value)},label:"Translation",variant:"outlined",children:s})},sn=n(1401),cn=n(1402),on=Object(l.a)((function(e){var t;return{appBar:{backgroundColor:e.palette.background.default},appBarSticky:(t={position:"fixed",left:"auto",right:"auto"},Object(c.a)(t,e.breakpoints.up("xs"),{width:e.sav3.layout.columns.middle.width.md-2*e.sav3.borderWidth}),Object(c.a)(t,e.breakpoints.down("xs"),{width:"calc(100% - ".concat(2*e.sav3.borderWidth,"px)")}),t),appBarStickyAfter:{height:e.sav3.topBar.height+e.sav3.borderWidth}}}));var un=function(e){var t=e.children,n=on();return Object(r.jsxs)("div",{children:[Object(r.jsxs)(sn.a,{position:"sticky",color:"transparent",elevation:0,classes:{positionSticky:n.appBarSticky},className:n.appBar,children:[Object(r.jsx)(cn.a,{disableGutters:!0,children:t}),Object(r.jsx)(yt.a,{})]}),Object(r.jsx)("div",{className:n.appBarStickyAfter})]})},ln=n(110),pn=n.n(ln),dn=n(1407),fn=n(1404),bn=n(1405),hn=n(213),jn=n.n(hn),vn=n(1403),gn=function(){return Object(a.useContext)(Q).languageCode},xn=n(212),On=n.n(xn),mn=n(570),yn=n(267),wn=n.n(yn),Cn=n(561),kn=n.n(Cn),Pn=n(562),Sn=n.n(Pn),In=n(20),Nn=n.n(In),Fn=new(function(){function e(){Object(ne.a)(this,e),this.followingCache=fe.createInstance({name:"followingCache"}),this.blockedCache=fe.createInstance({name:"blockedCache"})}return Object(re.a)(e,[{key:"addFollowing",value:function(){var e=Object(Z.a)(X.a.mark((function e(t){return X.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return de()("string"===typeof t,"FollowManager.addFollowing invalid userCid '".concat(t,"'")),e.next=3,this.deleteBlocked(t);case 3:return e.next=5,this.followingCache.setItem(t,!0);case 5:return e.t0=ht,e.next=8,this.getAllFollowing();case 8:e.t1=e.sent,e.t0.setFollowing.call(e.t0,e.t1);case 10:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"isFollowing",value:function(){var e=Object(Z.a)(X.a.mark((function e(t){var n;return X.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return de()("string"===typeof t,"FollowManager.isFollowing invalid userCid '".concat(t,"'")),e.next=3,this.followingCache.getItem(t);case 3:return n=e.sent,e.abrupt("return",!!n);case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"deleteFollowing",value:function(){var e=Object(Z.a)(X.a.mark((function e(t){return X.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return de()("string"===typeof t,"FollowManager.deleteFollowing invalid userCid '".concat(t,"'")),e.next=3,this.followingCache.removeItem(t);case 3:return e.t0=ht,e.next=6,this.getAllFollowing();case 6:e.t1=e.sent,e.t0.setFollowing.call(e.t0,e.t1);case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getAllFollowing",value:function(){return this.followingCache.keys()}},{key:"setAllFollowing",value:function(){var e=Object(Z.a)(X.a.mark((function e(t){var n,r,a;return X.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return de()(Array.isArray(t),"FollowManager.setAllFollowing invalid userCids '".concat(t,"'")),e.next=3,this.followingCache.clear();case 3:n=Object(te.a)(t),e.prev=4,n.s();case 6:if((r=n.n()).done){e.next=12;break}return a=r.value,e.next=10,this.addFollowing(a);case 10:e.next=6;break;case 12:e.next=17;break;case 14:e.prev=14,e.t0=e.catch(4),n.e(e.t0);case 17:return e.prev=17,n.f(),e.finish(17);case 20:return e.t1=ht,e.next=23,this.getAllFollowing();case 23:e.t2=e.sent,e.t1.setFollowing.call(e.t1,e.t2);case 25:case"end":return e.stop()}}),e,this,[[4,14,17,20]])})));return function(t){return e.apply(this,arguments)}}()},{key:"addBlocked",value:function(){var e=Object(Z.a)(X.a.mark((function e(t){return X.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return de()("string"===typeof t,"FollowManager.addBlocked invalid userCid '".concat(t,"'")),e.next=3,this.deleteFollowing(t);case 3:return e.next=5,this.blockedCache.setItem(t,!0);case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"isBlocked",value:function(){var e=Object(Z.a)(X.a.mark((function e(t){var n;return X.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return de()("string"===typeof t,"FollowManager.isBlocked invalid userCid '".concat(t,"'")),e.next=3,this.blockedCache.getItem(t);case 3:return n=e.sent,e.abrupt("return",!!n);case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"deleteBlocked",value:function(){var e=Object(Z.a)(X.a.mark((function e(t){return X.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return de()("string"===typeof t,"FollowManager.deleteBlocked invalid userCid '".concat(t,"'")),e.next=3,this.blockedCache.removeItem(t);case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getAllBlocked",value:function(){return this.blockedCache.keys()}},{key:"setAllBlocked",value:function(){var e=Object(Z.a)(X.a.mark((function e(t){var n,r,a;return X.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return de()(Array.isArray(t),"FollowManager.setAllBlocked invalid userCids '".concat(t,"'")),e.next=3,this.blockedCache.clear();case 3:n=Object(te.a)(t),e.prev=4,n.s();case 6:if((r=n.n()).done){e.next=12;break}return a=r.value,e.next=10,this.addBlocked(a);case 10:e.next=6;break;case 12:e.next=17;break;case 14:e.prev=14,e.t0=e.catch(4),n.e(e.t0);case 17:return e.prev=17,n.f(),e.finish(17);case 20:case"end":return e.stop()}}),e,this,[[4,14,17,20]])})));return function(t){return e.apply(this,arguments)}}()}]),e}()),Rn=Fn;window.followManager=Fn;var Un=Object(a.createContext)(),Bn=function(e){var t=Object(a.useState)({}),n=Object(d.a)(t,2),s=n[0],i=n[1],o=Object(a.useState)({}),u=Object(d.a)(o,2),l=u[0],p=u[1];Object(a.useEffect)((function(){Object(Z.a)(X.a.mark((function e(){var t,n,r,a,s,c,o,u,l,d;return X.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Rn.getAllFollowing();case 2:return t=e.sent,e.next=5,Rn.getAllBlocked();case 5:n=e.sent,r={},a=Object(te.a)(t);try{for(a.s();!(s=a.n()).done;)c=s.value,r[c]=!0}catch(f){a.e(f)}finally{a.f()}i(r),o={},u=Object(te.a)(n);try{for(u.s();!(l=u.n()).done;)d=l.value,o[d]=!0}catch(f){u.e(f)}finally{u.f()}p(o);case 14:case"end":return e.stop()}}),e)})))()}),[]);var f={following:s,addFollowing:function(e){de()("string"===typeof e,"FollowingProvider.addFollowing invalid userCid '".concat(e,"'")),Rn.addFollowing(e),i((function(t){return Object(ee.a)(Object(ee.a)({},t),{},Object(c.a)({},e,!0))}))},deleteFollowing:function(e){de()("string"===typeof e,"FollowingProvider.deleteFollowing invalid userCid '".concat(e,"'")),Rn.deleteFollowing(e),i((function(t){return Object(ee.a)(Object(ee.a)({},t),{},Object(c.a)({},e,!1))}))},setAllFollowing:function(e){de()(Array.isArray(e),"FollowingProvider.setAllFollowing invalid userCids '".concat(e,"'")),Rn.setAllFollowing(e);var t,n={},r=Object(te.a)(e);try{for(r.s();!(t=r.n()).done;){n[t.value]=!0}}catch(a){r.e(a)}finally{r.f()}i(n)},blocked:l,addBlocked:function(e){de()("string"===typeof e,"FollowingProvider.addBlocked invalid userCid '".concat(e,"'")),Rn.addBlocked(e),p((function(t){return Object(ee.a)(Object(ee.a)({},t),{},Object(c.a)({},e,!0))}))},deleteBlocked:function(e){de()("string"===typeof e,"FollowingProvider.deleteBlocked invalid userCid '".concat(e,"'")),Rn.deleteBlocked(e),p((function(t){return Object(ee.a)(Object(ee.a)({},t),{},Object(c.a)({},e,!1))}))},setAllBlocked:function(e){de()(Array.isArray(e),"FollowingProvider.setAllBlocked invalid userCids '".concat(e,"'")),Rn.setAllBlocked(e);var t,n={},r=Object(te.a)(e);try{for(r.s();!(t=r.n()).done;){n[t.value]=!0}}catch(a){r.e(a)}finally{r.f()}p(n)}},b=e.children;return Object(r.jsx)(Un.Provider,{value:f,children:b})},An=function(e){de()(!e||"string"===typeof e,"useIsFollowing invalid userCid '".concat(e,"'"));var t=Object(a.useContext)(Un),n=t.following,r=t.addFollowing,s=t.deleteFollowing,i=!!n[e],c=Object(a.useCallback)((function(t){e&&(de()("boolean"===typeof t,"setIsFollowing invalid value '".concat(t,"' not a boolean")),!0===t&&r(e),!1===t&&s(e))}),[e]);return e?[i,c]:[void 0,c]},Jn=Object(l.a)((function(e){return{menu:{"& .MuiPaper-rounded":{borderRadius:e.sav3.popoverMenu.borderRadius}},menuItemIcon:{minWidth:28,paddingTop:e.spacing(),paddingBottom:e.spacing()},moreIconButton:{padding:e.spacing(.5),"& .MuiSvgIcon-root":{fontSize:"1.2rem"}}}}));function Mn(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.userCid,n=Jn(),a=V(),s=An(t),i=Object(d.a)(s,2),c=i[0],o=i[1],u=Object(r.jsxs)(nn.a,{onClick:function(){return o(!0)},children:[Object(r.jsx)(h.a,{className:n.menuItemIcon,children:Object(r.jsx)(kn.a,{fontSize:"small"})}),Object(r.jsx)(Ut.a,{variant:"body1",children:a.Follow()})]});return c&&(u=Object(r.jsxs)(nn.a,{onClick:function(){return o(!1)},children:[Object(r.jsx)(h.a,{className:n.menuItemIcon,children:Object(r.jsx)(Sn.a,{fontSize:"small"})}),Object(r.jsx)(Ut.a,{variant:"body1",children:a.Unfollow()})]})),u}Mn.propTypes={userCid:Nn.a.string.isRequired};var Tn=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.post,n=Jn(),s=Object(a.useState)(null),i=Object(d.a)(s,2),c=i[0],o=i[1],u=Ft();if(t.userCid===u)return Object(r.jsx)(U.a,{height:48,width:48});var l=function(e){o(e.currentTarget)},p=function(){o(null)};return Object(r.jsxs)("div",{onClick:function(e){return e.stopPropagation()},children:[Object(r.jsx)(mt.a,{className:n.moreIconButton,onClick:l,children:Object(r.jsx)(wn.a,{})}),Object(r.jsx)(mn.a,{MenuListProps:{disablePadding:!0},className:n.menu,elevation:4,anchorOrigin:{vertical:"top",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},anchorEl:c,keepMounted:!0,open:Boolean(c),onClose:p,children:Object(r.jsx)(Mn,{userCid:t.userCid})})]})},zn=n(566),En=n.n(zn),Wn=n(268),Ln=n.n(Wn),qn=n(564),Dn=n.n(qn),Kn=n(1420),_n=xe()("sav3:utils:url"),Qn=Ye.a.urlTimeToLive;de()("number"===typeof Qn,"invalid permalink time to live '".concat(Qn,"'"));var Hn=function(e){var t,n,r;de()(e&&"string"===typeof e,"utils.url.decodeCid encodedCid '".concat(e,"' not a string"));try{var a=window.atob(Zn(e)).split(",");r=a[0],n=a[1],t=Gn(r,n)}catch(s){throw Error("failed decoding cid: ".concat(s.message))}if(1e3*n<Date.now())throw Error("encoded cid '".concat(t,"' expired '").concat(new Date(1e3*n),"'"));if(1e3*n-Qn>=Date.now())throw Error("encoded cid '".concat(t,"' too early, expires: '").concat(new Date(1e3*n),"', now: '").concat(new Date,"'"));return _n("decodeCid",{cid:t,expireTimestamp:n,cipheredCid:r}),t},Vn=function(e,t){for(var n=t%7,r="";r.length<e.length;){var a=r.length;r+=String.fromCharCode(e.charCodeAt(a)+n)}return r},Gn=function(e,t){for(var n=t%7,r="";r.length<e.length;){var a=r.length;r+=String.fromCharCode(e.charCodeAt(a)-n)}return r},Xn=function(e){return e.replace("/","-")},Zn=function(e){return e.replace("-","/")},$n=Hn,Yn=function(e){de()(e&&"string"===typeof e,"utils.url.encodeCid cid '".concat(e,"' not a string"));var t=Math.floor((Date.now()+Qn)/1e3),n=Vn(e,t);return _n("encodeCid",{cid:e,expireTimestamp:t,cipheredCid:n}),Xn(window.btoa("".concat(n,",").concat(t)).replace(/=/g,""))},er=function(e){try{return Hn(e),!1}catch(t){return _n("encodedCidIsExpired",t.message),!0}},tr=function(){};var nr=function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=Object(a.useRef)(tr);Object(a.useEffect)((function(){r.current=e})),Object(a.useEffect)((function(){n&&null!==t&&!1!==t&&r.current()}),[n]),Object(a.useEffect)((function(){if(null!==t&&!1!==t){var e=setInterval((function(){return r.current()}),t);return function(){return clearInterval(e)}}}),[t])},rr=function(e){de()(!e||"string"===typeof e,"invalid postCid '".concat(JSON.stringify(e),"'"));var t=Object(a.useState)([]),n=Object(d.a)(t,2),r=n[0],s=n[1];return nr((function(){e?Object(Z.a)(X.a.mark((function t(){var n;return X.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,ht.getPostReplyCids(e);case 2:if(n=t.sent,JSON.stringify(n)!==JSON.stringify(r)){t.next=5;break}return t.abrupt("return");case 5:s(n);case 6:case"end":return t.stop()}}),t)})))():0!==r.length&&s([])}),1e3),r},ar=function(e){de()(!e||"string"===typeof e,"invalid postCid '".concat(JSON.stringify(e),"'"));var t=Object(a.useState)([]),n=Object(d.a)(t,2),r=n[0],s=n[1];return nr((function(){e?Object(Z.a)(X.a.mark((function t(){var n;return X.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,ht.getPostQuoteCids(e);case 2:if(n=t.sent,JSON.stringify(n)!==JSON.stringify(r)){t.next=5;break}return t.abrupt("return");case 5:s(n);case 6:case"end":return t.stop()}}),t)})))():0!==r.length&&s([])}),1e3),r},sr=n(563),ir=n.n(sr);function cr(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:500,t=Object(a.useState)(!1),n=Object(d.a)(t,2),r=n[0],s=n[1],i=Object(a.useCallback)((function(e){var t=ir()(e);s(t)}),[]);return Object(a.useEffect)((function(){if(r){var t=setTimeout((function(){s(!1)}),e);return function(){clearTimeout(t)}}}),[r,s,e]),[r,i]}var or=Object(l.a)((function(e){return{actions:{paddingTop:e.spacing(.5),maxWidth:.75*e.sav3.layout.columns.middle.width.md,marginLeft:e.spacing(-1)},actionIconButton:{padding:e.spacing(1),"& .MuiSvgIcon-root":{fontSize:"1rem",color:e.palette.text.secondary}},menu:{"& .MuiPaper-rounded":{borderRadius:e.sav3.popoverMenu.borderRadius}},menuItemIcon:{minWidth:28,paddingTop:e.spacing(),paddingBottom:e.spacing()}}}));function ur(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.parentPost,n=or(),s=rr(t.cid),i=Object(a.useState)(!1),c=Object(d.a)(i,2),o=c[0],u=c[1];return Object(r.jsxs)(U.a,{display:"flex",alignItems:"center",onClick:function(e){return e.stopPropagation()},children:[Object(r.jsx)(mt.a,{className:n.actionIconButton,onClick:function(){return u(!0)},children:Object(r.jsx)(Dn.a,{})}),0!==s.length&&Object(r.jsx)(Ut.a,{variant:"caption",children:s.length}),Object(r.jsx)(Jt,{parentPost:t,open:o,onClose:function(){return u(!1)}})]})}function lr(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.postCid,n=or(),a=V(),s=cr(1100),i=Object(d.a)(s,2),c=i[0],o=i[1],u=function(){var e=Yn(t);return"".concat(window.location.origin,"/#/post/").concat(e)};return Object(r.jsx)(Kn.a,{title:a["Copied to clipboard"](),open:c,enterDelay:500,leaveDelay:200,children:Object(r.jsx)(mt.a,{onClick:function(){return o(u())},className:n.actionIconButton,children:Object(r.jsx)(Ln.a,{})})})}function pr(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.quotedPost,n=or(),s=ar(t.cid),i=Object(a.useState)(null),c=Object(d.a)(i,2),o=c[0],u=c[1],l=function(e){u(e.currentTarget)},p=function(){u(null)},f=function(){var e=Object(Z.a)(X.a.mark((function e(){return X.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ht.publishPost({quotedPostCid:t.cid});case 2:p();case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(r.jsxs)(U.a,{display:"flex",alignItems:"center",onClick:function(e){return e.stopPropagation()},children:[Object(r.jsx)(mt.a,{className:n.actionIconButton,onClick:l,children:Object(r.jsx)(jn.a,{style:{transform:"rotate(90deg)"}})}),0!==s.length&&Object(r.jsx)(Ut.a,{variant:"caption",children:s.length}),Object(r.jsx)(mn.a,{MenuListProps:{disablePadding:!0},className:n.menu,elevation:4,anchorOrigin:{vertical:"top",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},anchorEl:o,keepMounted:!0,open:Boolean(o),onClose:p,children:Object(r.jsx)(dr,{onClick:f})})]})}function dr(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.onClick,n=or();return Object(r.jsxs)(nn.a,{onClick:t,children:[Object(r.jsx)(h.a,{className:n.menuItemIcon,children:Object(r.jsx)(jn.a,{fontSize:"small",style:{transform:"rotate(90deg)"}})}),Object(r.jsx)(Ut.a,{children:"RESAV3"})]})}function fr(){var e=or();return Object(r.jsx)(mt.a,{className:e.actionIconButton,children:Object(r.jsx)(En.a,{})})}var br=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.post,n=or();return Object(r.jsxs)(U.a,{display:"flex",justifyContent:"space-between",className:n.actions,children:[Object(r.jsx)(ur,{parentPost:t}),Object(r.jsx)(pr,{quotedPost:t}),Object(r.jsx)(fr,{}),Object(r.jsx)(lr,{postCid:t.cid})]})},hr=function(e,t){de()("string"===typeof e,"themesUtils.scaleRgbaAlpha invalid rgbaString '".concat(e,"'")),de()("string"===typeof t||"number"===typeof t,"themesUtils.scaleRgbaAlpha invalid alpha '".concat(t,"'"));var n=e.match(/[\d.]+/g),r=Object(d.a)(n,4),a=r[0],s=r[1],i=r[2],c=r[3];return"rgba(".concat(a,", ").concat(s,", ").concat(i,", ").concat((c*t).toFixed(3),")")},jr=Object(l.a)((function(e){return{imgMedia:{height:0,paddingTop:"56.25%"},avatar:{marginTop:e.spacing(-.25),width:e.spacing(6),height:e.spacing(6),borderWidth:e.sav3.borderWidth,borderStyle:"solid",borderColor:e.sav3.borderColor},resav3d:{marginTop:e.spacing(-.25)},parentPostLine:{margin:"auto",width:2},userCid:{wordBreak:"break-all",textDecoration:"inherit","&:hover":{textDecoration:"underline"}},displayName:{color:"inherit",textDecoration:"inherit","&:hover":{textDecoration:"underline"}},contentLink:{wordBreak:"break-all"},post:{cursor:"pointer","&:hover":{backgroundColor:hr(e.palette.action.hover,.4)},tapHighlightColor:"rgba(0, 0, 0, 0)",userSelect:"none"}}}));function vr(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.post,n=e.isParent,s=e.isResav3,i=e.quotingPost,c=Object(o.g)(),u=Object(o.f)(),l=gn(),p=jr(),f=kr(t.timestamp,l),b=Yn(t.userCid),h="/profile/".concat(b),j=Yn(t.cid),v="/post/".concat(j),g=function(e){if(e.target.tagName.match(/DIV|P/)){var n=c.pathname.split("/"),r=Object(d.a)(n,3),a=r[1],s=r[2];if("post"===a)try{if($n(s)===t.cid)return}catch(i){}u.push(v)}};return Object(r.jsxs)(U.a,{pt:1.5,className:p.post,onClick:g,children:[s&&Object(r.jsx)(gr,{post:t,quotingPost:i}),Object(r.jsxs)(U.a,{px:2,pb:.5,display:"flex",children:[Object(r.jsxs)(U.a,{pr:1.5,children:[Object(r.jsx)(Rt.a,{component:M.b,to:h,src:t.profile.thumbnailUrl&&yr(t.profile.thumbnailUrl),className:p.avatar}),n&&Object(r.jsx)(yt.a,{className:p.parentPostLine,orientation:"vertical"})]}),Object(r.jsxs)(U.a,{width:"100%",children:[Object(r.jsxs)(U.a,{display:"flex",children:[Object(r.jsxs)(U.a,{flexGrow:1,children:[Object(r.jsxs)(U.a,{display:"flex",children:[t.profile.displayName&&Object(r.jsxs)(a.Fragment,{children:[Object(r.jsx)(Ut.a,{className:p.displayName,component:M.b,to:h,variant:"subtitle2",children:t.profile.displayName}),"\xa0",Object(r.jsx)(Ut.a,{variant:"subtitle2",children:"\xb7"}),"\xa0"]}),Object(r.jsx)(Ut.a,{variant:"subtitle2",children:f})]}),Object(r.jsx)(U.a,{children:Object(r.jsx)(Ut.a,{component:M.b,to:h,variant:"caption",color:"textSecondary",className:p.userCid,children:t.userCid})})]}),Object(r.jsx)(U.a,{children:Object(r.jsx)(Tn,{post:t})})]}),Object(r.jsx)(xr,{content:t.content}),Object(r.jsx)(br,{post:t})]})]})]})}function gr(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.quotingPost,n=Object(p.a)(),a=jr(),s=Yn(t.userCid),i="/profile/".concat(s);return Object(r.jsxs)(U.a,{className:a.resav3d,px:2,pb:.5,display:"flex",alignItems:"center",children:[Object(r.jsx)(U.a,{width:n.spacing(6),mr:1.5,display:"flex",justifyContent:"flex-end",children:Object(r.jsx)(jn.a,{style:{transform:"rotate(90deg) translateX(-1px)",color:n.palette.text.secondary,fontSize:"1.4rem"}})}),Object(r.jsxs)(Ut.a,{style:{fontWeight:"bold"},color:"textSecondary",variant:"overline",className:a.userCid,component:M.b,to:i,children:[t.profile.displayName||t.userCid.substring(0,8)," RESAV3D"]})]})}function xr(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.content,n=jr(),a=[t],s=Or(t);if(s){var i=t.split(s),c=Object(d.a)(i,2),o=c[0],u=c[1],l=s;s.match(/^https?:\/\//)||(l="https://".concat(s)),a=[],o&&a.push(o),a.push(Object(r.jsx)(vn.a,{className:n.contentLink,variant:"body2",href:l,target:"_blank",rel:"noopener",children:s},"content link")),u&&a.push(u)}var p,f=mr(t);f&&(p=Object(r.jsx)(fn.a,{className:n.imgMedia,image:f}),wr(f)&&(p=Object(r.jsx)(fn.a,{controls:!0,autoPlay:!0,muted:!0,component:"video",image:f})));var b=f&&Object(r.jsx)(U.a,{pt:1,children:Object(r.jsx)(bn.a,{variant:"outlined",children:p})});return Object(r.jsxs)(U.a,{children:[Object(r.jsx)(Ut.a,{variant:"body2",children:a}),b]})}var Or=function(e){if(e){de()("string"===typeof e,"post content '".concat(e,"' is not a string"));var t=e.match(On()({strict:!1}));return t&&t[0]}},mr=function(e){if(e){de()("string"===typeof e,"post content '".concat(e,"' is not a string"));var t=e.match(On()({strict:!1})),n=t&&t[0];if(n)return n=yr(n),Cr(n)?(n.match(/^https?:\/\//)||(n="https://".concat(n)),n):void 0}},yr=function(e){return de()("string"===typeof e,"forceHttps link '".concat(e,"' not a string")),e=(e=e.trim()).replace(/^http:\/\//,"https://")},wr=function(e){return e.replace(/[#?].*/,"").match(/\.(mp4|webm)$/)},Cr=function(e){return e.replace(/[#?].*/,"").match(/\.(jpeg|jpg|png|gif|mp4|webm)$/)},kr=function(e,t){var n=Object(a.useState)(),r=Object(d.a)(n,2),s=r[0],i=r[1];return Object(a.useEffect)((function(){var n=Pr(e,t);i(n)}),[e,t]),s},Pr=function(e,t){var n=864e5,r=1e3*e,a=new Date(r).toLocaleString(t,{month:"short",day:"numeric"});return Date.now()>r+31536e6&&(a=new Date(r).toLocaleString(t,{year:"numeric",month:"short",day:"numeric"})),Date.now()<r+n&&(a=Object(L.a)(r,t)),a},Sr=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.post,n=[];return t.parentPost&&!t.quotedPost&&n.push(Object(r.jsx)(vr,{isParent:!0,post:t.parentPost},"parent")),t.quotedPost?n.push(Object(r.jsx)(vr,{quotingPost:t,isResav3:!0,post:t.quotedPost},"quoted")):n.push(Object(r.jsx)(vr,{isParent:t.isParent,post:t},t.cid)),Object(r.jsx)(a.Fragment,{children:n})},Ir=n(567),Nr=n(1406);var Fr=function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.posts,a=t.next,s=t.hasMore,i=[],c=Object(te.a)(n);try{for(c.s();!(e=c.n()).done;){var o=e.value;i.push(Object(r.jsxs)("div",{children:[Object(r.jsx)(Sr,{post:o}),Object(r.jsx)(yt.a,{})]},o.contentCid+o.timestamp))}}catch(u){c.e(u)}finally{c.f()}return Object(r.jsx)(Ir.a,{dataLength:i.length,next:a,hasMore:s,loader:Object(r.jsx)(U.a,{width:"100%",p:2,justifyContent:"center",display:"flex",style:{overflow:"hidden"},children:Object(r.jsx)(Nr.a,{size:24})}),children:i})};var Rr=function(e){if(e){de()("string"===typeof e,"user description '".concat(e,"' is not a string"));var t=e.match(On()({strict:!1}));return t&&t[0]}},Ur=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.description,n=[t],a=Rr(t);if(a){var s=t.split(a),i=Object(d.a)(s,2),c=i[0],o=i[1],u=a;a.match(/$https?:\/\//)||(u="https://".concat(a)),n=[],c&&n.push(c),n.push(Object(r.jsx)(vn.a,{variant:"body2",href:u,target:"_blank",rel:"noopener",children:a})),o&&n.push(o)}return Object(r.jsx)(Ut.a,{variant:"body2",children:n})},Br=Object(l.a)((function(e){return{errorMessage:{overflow:"hidden"},description:{"& textarea":{overflow:"hidden"}},content:{"& input":{padding:e.spacing(2),paddingLeft:e.spacing(2.5),paddingRight:e.spacing(2.5)},'& label[data-shrink="false"]':{transform:"translate(20px, 18px) scale(1)"},"& textarea":{paddingTop:e.spacing(1),paddingBottom:e.spacing(1),paddingLeft:e.spacing(.5),paddingRight:e.spacing(.5)},"& fieldset":{opacity:.25},"& .Mui-focused fieldset":{opacity:1}}}}));var Ar=function(e){var t=e.open,n=e.onClose,s=e.previousProfile,i=V(),o=Br(),u=Object(a.useState)(s),l=Object(d.a)(u,2),p=l[0],f=l[1],b=Object(a.useState)(),h=Object(d.a)(b,2),j=h[0],v=h[1];Object(a.useEffect)((function(){f(s)}),[JSON.stringify(s)]);var g=function(e){var t=e.target,n=t.id,r=t.value,a=Object(ee.a)(Object(ee.a)({},p),{},Object(c.a)({},n,r));f(a)},x=function(){var e=Object(Z.a)(X.a.mark((function e(){return X.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,ht.editUserProfile(p);case 3:v(null),n(),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),v(e.t0.message);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}(),O=Object(r.jsxs)(U.a,{pt:1,pb:1.5,className:o.content,children:[Object(r.jsx)($.a,{onChange:g,autoFocus:!0,margin:"dense",id:"displayName",label:i["Display name"](),fullWidth:!0,variant:"outlined",value:p.displayName||""}),Object(r.jsx)($.a,{onChange:g,margin:"dense",id:"thumbnailUrl",label:i["Thumbnail URL"](),fullWidth:!0,variant:"outlined",value:p.thumbnailUrl||""}),Object(r.jsx)($.a,{onChange:g,margin:"dense",id:"bannerUrl",label:i["Banner URL"](),fullWidth:!0,variant:"outlined",value:p.bannerUrl||""}),Object(r.jsx)($.a,{className:o.description,onChange:g,margin:"dense",id:"description",label:i.Description(),fullWidth:!0,multiline:!0,rows:4,variant:"outlined",value:p.description||""}),j&&Object(r.jsx)(jt.a,{classes:{message:o.errorMessage},severity:"error",children:j})]}),m=Object(r.jsx)("div",{children:Object(r.jsx)(R.a,{disableElevation:!0,variant:"contained",onClick:x,color:"primary",children:"SAV3"})});return Object(r.jsx)(kt,{open:t,onClose:n,content:O,actions:m})},Jr=Object(l.a)((function(e){return{menu:{"& .MuiPaper-rounded":{borderRadius:e.sav3.popoverMenu.borderRadius}},menuItemIcon:{minWidth:28,paddingTop:e.spacing(1),paddingBottom:e.spacing(1)},moreIconButton:{padding:e.spacing(1.25)}}}));function Mr(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.userCid,n=e.onClose,a=Jr(),s=V(),i=cr(1100),c=Object(d.a)(i,2),o=c[0],u=c[1],l=function(){var e=Yn(t);return"".concat(window.location.origin,"/#/profile/").concat(e)},p=function(){u(l()),n&&n()};return Object(r.jsx)(Kn.a,{title:s["Copied to clipboard"](),open:o,enterDelay:500,leaveDelay:200,children:Object(r.jsxs)(nn.a,{button:!0,onClick:p,children:[Object(r.jsx)(h.a,{className:a.menuItemIcon,children:Object(r.jsx)(Ln.a,{fontSize:"small"})}),Object(r.jsx)(Ut.a,{variant:"body1",children:s.Share()})]})})}var Tr=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.userCid,n=Jr(),s=Object(a.useState)(null),i=Object(d.a)(s,2),c=i[0],o=i[1],u=function(e){o(e.currentTarget)},l=function(){o(null)};return Object(r.jsxs)("div",{children:[Object(r.jsx)(mt.a,{className:n.moreIconButton,onClick:u,children:Object(r.jsx)(wn.a,{})}),Object(r.jsx)(mn.a,{MenuListProps:{disablePadding:!0},className:n.menu,elevation:4,anchorOrigin:{vertical:"top",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},anchorEl:c,keepMounted:!0,open:Boolean(c),onClose:l,children:Object(r.jsx)(Mr,{userCid:t,onClose:l})})]})};var zr=function(e){var t=Object(a.useRef)();return Object(a.useEffect)((function(){t.current=e}),[e]),t.current},Er=xe()("sav3:hooks:use-user-post-cids"),Wr=function(e){de()(!e||"string"===typeof e,"invalid userCid '".concat(JSON.stringify(e),"'"));var t=St(e),n=t&&t.lastPostCid,r=Object(a.useState)([]),s=Object(d.a)(r,2),i=s[0],c=s[1];Er({userIpnsContent:t,lastPostCid:n,userPostCids:i});var o=zr(e),u=o&&o!==e;return Object(a.useEffect)((function(){if(n&&!u){var e=100,t=!0;return Object(Z.a)(X.a.mark((function r(){var a,s,o,u,l,p,d,f;return X.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:a=!0,s=!1,r.prev=2,u=function(){var n=d;return t?i.includes(n)?"continue":(c((function(e){return[].concat(Object(Y.a)(e),[n])})),e--?void 0:{v:void 0}):{v:void 0}},l=Object(We.a)(ht.getPreviousPostCids(n));case 5:return r.next=7,l.next();case 7:return p=r.sent,a=p.done,r.next=11,p.value;case 11:if(d=r.sent,a){r.next=21;break}if("continue"!==(f=u())){r.next=16;break}return r.abrupt("continue",18);case 16:if("object"!==typeof f){r.next=18;break}return r.abrupt("return",f.v);case 18:a=!0,r.next=5;break;case 21:r.next=27;break;case 23:r.prev=23,r.t0=r.catch(2),s=!0,o=r.t0;case 27:if(r.prev=27,r.prev=28,a||null==l.return){r.next=32;break}return r.next=32,l.return();case 32:if(r.prev=32,!s){r.next=35;break}throw o;case 35:return r.finish(32);case 36:return r.finish(27);case 37:case"end":return r.stop()}}),r,null,[[2,23,27,37],[28,,32,36]])})))(),function(){t=!1}}i.length&&c([])}),[n,e]),i},Lr=xe()("sav3:hooks:use-posts"),qr=function(e){de()(Array.isArray(e),"invalid postCids '".concat(JSON.stringify(e),"'"));var t={},n=Object(a.useState)(t),r=Object(d.a)(n,2),s=r[0],i=r[1];Lr({postCids:e,posts:s});var o=new Set(e),u=zr(o),l=function(e,t){return i((function(n){return Object(ee.a)(Object(ee.a)({},n),{},Object(c.a)({},e,t))}))};return Object(a.useEffect)((function(){if(e.length){var n,r=Object(te.a)(o);try{var a=function(){var t=n.value;if(de()(t&&"string"===typeof t,"usePosts invalid postCid '".concat(t,"' in '").concat(JSON.stringify(e),"'")),u&&u.has(t))return"continue";ht.getPost(t).then((function(e){var n=e.parentPostCid,r=e.quotedPostCid;r&&!s[r]?ht.getPost(r).then((function(n){l(t,e),l(r,n)})):n&&!s[n]?ht.getPost(n).then((function(r){l(t,e),l(n,r)})):l(t,e)}))};for(r.s();!(n=r.n()).done;)a()}catch(c){r.e(c)}finally{r.f()}}else JSON.stringify(s)!==JSON.stringify(t)&&i(t)}),[JSON.stringify(e)]),s},Dr=xe()("sav3:hooks:use-users-ipns-contents"),Kr=function(e){var t,n={},r=Object(te.a)(e);try{for(r.s();!(t=r.n()).done;){n[t.value]={}}}catch(a){r.e(a)}finally{r.f()}return n},_r=function(e){de()(Array.isArray(e),"invalid ipnsPaths '".concat(JSON.stringify(e),"'"));var t,n=Object(te.a)(e);try{for(n.s();!(t=n.n()).done;){var r=t.value;de()(r&&"string"===typeof r,"invalid ipnsPaths '".concat(JSON.stringify(e),"' contains non string"))}}catch(v){n.e(v)}finally{n.f()}var s,i=Object(a.useState)(Kr(e)),o=Object(d.a)(i,2),u=o[0],l=o[1],p=new Set(e),f=zr(p),b=[],h=Object(te.a)(p);try{for(h.s();!(s=h.n()).done;){var j=s.value;f&&f.has(j)||b.push(j)}}catch(v){h.e(v)}finally{h.f()}Dr({ipnsPaths:e,usersIpnsContents:u,unsubscribedIpnsPaths:b});return Object(a.useEffect)((function(){if(function(){var t,n=[],r=[],a=Object(te.a)(e);try{for(a.s();!(t=a.n()).done;){var s=t.value;u[s]||n.push(s)}}catch(v){a.e(v)}finally{a.f()}for(var i in u)p.has(i)||r.push(i);(n.length||r.length)&&l((function(e){var t,a=Object(ee.a)({},e),s=Object(te.a)(n);try{for(s.s();!(t=s.n()).done;){var i=t.value;a[i]||(a[i]={})}}catch(v){s.e(v)}finally{s.f()}var c,o=Object(te.a)(r);try{for(o.s();!(c=o.n()).done;)delete a[c.value]}catch(v){o.e(v)}finally{o.f()}return a}))}(),b.length){var t=function(){var e=Object(Z.a)(X.a.mark((function e(t,n){var r;return X.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(p.has(t)){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,ht.getUserIpnsContent(n);case 4:r=e.sent,l((function(e){return Object(ee.a)(Object(ee.a)({},e),{},Object(c.a)({},t,r))}));case 6:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}();return ht.on("publish",t),Object(Z.a)(X.a.mark((function e(){var t,n,r,a;return X.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ht.subscribeToIpnsPaths(b);case 2:t=e.sent,n=Object(te.a)(t.entries()),e.prev=4,a=function(){var e=Object(d.a)(r.value,2),t=e[0],n=e[1];if(!n)return"continue";var a=b[t];ht.getUserIpnsContent(n).then((function(e){l((function(t){return Object(ee.a)(Object(ee.a)({},t),{},Object(c.a)({},a,e))}))}))},n.s();case 7:if((r=n.n()).done){e.next=13;break}if("continue"!==a()){e.next=11;break}return e.abrupt("continue",11);case 11:e.next=7;break;case 13:e.next=18;break;case 15:e.prev=15,e.t0=e.catch(4),n.e(e.t0);case 18:return e.prev=18,n.f(),e.finish(18);case 21:case"end":return e.stop()}}),e,null,[[4,15,18,21]])})))(),function(){ht.off("publish",t)}}}),[JSON.stringify(e)]),u},Qr=xe()("sav3:hooks:use-users-profiles"),Hr=function(e){de()(Array.isArray(e),"invalid userCids '".concat(JSON.stringify(e),"'"));var t=Object(a.useState)({}),n=Object(d.a)(t,2),r=n[0],s=n[1],i=_r(e),o={};for(var u in i)o[u]=i[u].profileCid;var l=zr(o);Qr({usersIpnsContents:i,userCids:e,profileCids:o,previousProfileCids:l,usersProfiles:r});return Object(a.useEffect)((function(){var e=function(e){var t=o[e];return t?(de()("string"===typeof t,"useUsersProfiles invalid profileCid '".concat(t,"' in '").concat(JSON.stringify(o),"'")),function(e){return l&&l[e]&&l[e].profileCid&&o[e]&&o[e].profileCid===l[e].profileCid}(e)?"continue":void ht.getUserProfile(t).then((function(t){s((function(n){return Object(ee.a)(Object(ee.a)({},n),{},Object(c.a)({},e,t))}))}))):"continue"};for(var t in o)e(t)}),[JSON.stringify(o)]),r},Vr=xe()("sav3:hooks:feed:use-user-posts"),Gr=function(e){var t=new Set;for(var n in e)e[n]&&e[n].userCid&&t.add(e[n].userCid);return Object(Y.a)(t)},Xr=function(e){var t=zr(e),n=Wr(e),r=qr(n),s=Gr(r),i=new Set(s);e&&i.add(e);var c,o=Hr(Object(Y.a)(i)),u=Object(a.useState)(10),l=Object(d.a)(u,2),p=l[0],f=l[1],b=Object(a.useState)([]),h=Object(d.a)(b,2),j=h[0],v=h[1],g=[],x=Object(te.a)(n);try{for(x.s();!(c=x.n()).done;){var O=c.value;r[O]&&g.push(r[O])}}catch(B){x.e(B)}finally{x.f()}var m=function(){f(10),v([])},y=g.length>j.length;Object(a.useEffect)((function(){if(t&&t!==e&&m(),!(j.length>=p)&&!(g.length<=j.length)){var n=g.sort((function(e,t){return t.timestamp-e.timestamp}));v((function(e){var t,r=[],a=Object(te.a)(n);try{for(a.s();!(t=a.n()).done;){var s=t.value;if(r.length>=p)break;r.push(s)}}catch(B){a.e(B)}finally{a.f()}return r}))}}),[e,p,JSON.stringify(g),JSON.stringify(o)]);var w,C=JSON.parse(JSON.stringify(j)),k=Object(te.a)(C);try{for(k.s();!(w=k.n()).done;){var P=w.value;P.profile=o[P.userCid]||{}}}catch(B){k.e(B)}finally{k.f()}var S,I=Object(te.a)(C);try{for(I.s();!(S=I.n()).done;){var N=S.value;N.parentPost=r[N.parentPostCid],N.parentPost&&(N.parentPost.profile=o[N.parentPost.userCid]||{})}}catch(B){I.e(B)}finally{I.f()}var F,R=Object(te.a)(C);try{for(R.s();!(F=R.n()).done;){var U=F.value;U.quotedPost=r[U.quotedPostCid],U.quotedPost&&(U.quotedPost.profile=o[U.quotedPost.userCid]||{})}}catch(B){R.e(B)}finally{R.f()}return Vr({userPosts:j,postsWithAllData:C,postCount:p,posts:r,hasMore:y}),{posts:C,next:function(){f((function(e){return e+10}))},hasMore:y,reset:m}},Zr=xe()("sav3:views:profile"),$r="data:image/png;base64,",Yr=Object(l.a)((function(e){return{banner:{paddingTop:"33.25%"},avatar:Object(c.a)({position:"absolute",width:e.sav3.layout.columns.middle.width.md/4,height:e.sav3.layout.columns.middle.width.md/4,marginTop:e.sav3.layout.columns.middle.width.md/-8,marginLeft:e.spacing(2),borderWidth:e.spacing(.5),borderStyle:"solid",borderColor:e.palette.background.default},e.breakpoints.down(e.sav3.layout.columns.middle.width.md),{width:"25vw",height:"25vw",marginTop:"-12.5vw",borderWidth:e.spacing(.25)}),displayName:{wordBreak:"break-all"}}}));function ea(e){var t=e.profile,n=V(),s=Object(a.useState)(!1),i=Object(d.a)(s,2),c=i[0],o=i[1];return Object(r.jsxs)("div",{children:[Object(r.jsx)(R.a,{variant:"outlined",size:"large",color:"primary",onClick:function(){return o(!0)},children:n["Edit profile"]()}),Object(r.jsx)(Ar,{previousProfile:t,open:c,onClose:function(){return o(!1)}})]})}function ta(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.userCid,n=V(),a=An(t),s=Object(d.a)(a,2),i=s[0],c=s[1],o=function(e){t&&c(e)},u=Object(r.jsx)(R.a,{variant:"outlined",size:"large",color:"primary",onClick:function(){return o(!0)},children:n.Follow()});return i&&(u=Object(r.jsx)(R.a,{variant:"outlined",size:"large",color:"primary",onClick:function(){return o(!1)},children:n.Unfollow()})),u}ta.propTypes={userCid:Nn.a.string};var na=function(e){return de()("string"===typeof e,"forceHttps link '".concat(e,"' not a string")),e=(e=e.trim()).replace(/^http:\/\//,"https://")},ra=function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.userCid,a=Ft(),s=Yr(),i=Nt(n),c=Xr(n),o=c.posts,u=c.next,l=c.hasMore;Zr({ownCid:a,userCid:n,posts:o,profile:i}),n===a?e=Object(r.jsx)(ea,{profile:i}):a&&(e=Object(r.jsx)(ta,{userCid:n}));var p=i.description||"";return p&&p.length>140&&(p=p.substring(0,140)),Object(r.jsxs)("div",{className:s.root,children:[Object(r.jsx)(fn.a,{className:s.banner,image:i.bannerUrl&&na(i.bannerUrl)||$r}),Object(r.jsx)(Rt.a,{src:i.thumbnailUrl&&na(i.thumbnailUrl),className:s.avatar}),Object(r.jsxs)(U.a,{p:2,pb:0,display:"flex",flexDirection:"row-reverse",children:[e,Object(r.jsx)(Tr,{userCid:n})]}),Object(r.jsx)(dn.a,{className:s.displayName,pb:0,title:i.displayName,subheader:n}),Object(r.jsx)(U.a,{p:2,pt:0,children:Object(r.jsx)(Ur,{description:p})}),Object(r.jsx)(yt.a,{}),Object(r.jsx)(Fr,{posts:o,next:u,hasMore:l})]})},aa=xe()("sav3:views:profile");var sa=function(){var e,t=Object(o.h)().encodedCid,n=t&&er(t);!n&&t&&(e=$n(t));var a,s=!t,i=Ft(),c=Nt(a=s?i:e),u=Object(o.f)(),l=V();return aa({userCid:a,urlUserCid:e,urlIsExpired:n,isOwnProfile:s}),Object(r.jsxs)("div",{children:[Object(r.jsxs)(un,{children:[Object(r.jsx)(U.a,{pr:1,children:Object(r.jsx)(mt.a,{onClick:function(){return u.goBack()},children:Object(r.jsx)(pn.a,{})})}),Object(r.jsx)(Ut.a,{noWrap:!0,variant:"h6",children:c.displayName||s&&l["Edit profile"]()})]}),n&&Object(r.jsx)(U.a,{width:"100%",py:4,display:"flex",justifyContent:"center",alignItems:"center",children:Object(r.jsx)(Ut.a,{variant:"body1",children:l["URL expired"]()+"."})}),!n&&Object(r.jsx)(ra,{userCid:a})]})},ia=function(){var e=Object(a.useState)(),t=Object(d.a)(e,2),n=t[0],r=t[1];return Object(a.useEffect)((function(){Object(Z.a)(X.a.mark((function e(){var t;return X.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ht.getOwnPeerCid();case 2:t=e.sent,r(t);case 4:case"end":return e.stop()}}),e)})))()}),[]),n},ca=n(1417),oa=Object(l.a)((function(e){return{text:{},root:{width:e.sav3.drawerMenu.width}}}));var ua=function(){var e=oa(),t=V();return Object(r.jsx)("div",{className:e.root,children:Object(r.jsxs)(f.a,{children:[Object(r.jsxs)(b.a,{button:!0,component:M.b,to:"/following",children:[Object(r.jsx)(h.a,{children:Object(r.jsx)(C.a,{fontSize:"large"})}),Object(r.jsx)(j.a,{primary:t.Following(),className:e.text})]}),Object(r.jsxs)(b.a,{button:!0,component:M.b,to:"/stats",children:[Object(r.jsx)(h.a,{children:Object(r.jsx)(P.a,{fontSize:"large"})}),Object(r.jsx)(j.a,{primary:t.Stats(),className:e.text})]}),Object(r.jsxs)(b.a,{button:!0,component:M.b,to:"/profile",children:[Object(r.jsx)(h.a,{children:Object(r.jsx)(O.a,{fontSize:"large"})}),Object(r.jsx)(j.a,{primary:t.Profile(),className:e.text})]}),Object(r.jsxs)(b.a,{children:[Object(r.jsx)(rn,{}),Object(r.jsx)(an,{})]})]})})},la=Object(l.a)((function(e){return{avatar:{width:e.sav3.topBar.height/1.75,height:e.sav3.topBar.height/1.75}}}));var pa=function(){var e=ia(),t=la(),n=Nt(e),s=Object(a.useState)(!1),i=Object(d.a)(s,2),c=i[0],o=i[1];return Object(r.jsxs)("div",{children:[Object(r.jsx)(mt.a,{style:{backgroundColor:"transparent"},disableRipple:!0,disableFocusRipple:!0,onClick:function(){return o(!0)},children:Object(r.jsx)(Rt.a,{src:n.thumbnailUrl,className:t.avatar})}),Object(r.jsx)(ca.a,{achor:"left",elevation:2,open:c,onClose:function(){return o(!1)},children:Object(r.jsx)(ua,{})})]})},da=Object(l.a)((function(e){return{errorMessage:{overflow:"hidden"},content:{"& textarea":{overflow:"hidden"},"& fieldset":{border:"none"},"& .MuiInputBase-root":{paddingLeft:0,paddingRight:0},marginBottom:e.spacing(1),marginLeft:e.spacing(.5)},contentInput:{paddingTop:0,paddingBottom:0},avatar:{marginTop:e.spacing(-.25),width:e.spacing(6),height:e.spacing(6),borderWidth:e.sav3.borderWidth,borderStyle:"solid",borderColor:e.sav3.borderColor}}}));var fa=function(){var e=V(),t=da(),n=Object(p.a)(),s=Ft(),i=Nt(s),c=Object(a.useState)(""),o=Object(d.a)(c,2),u=o[0],l=o[1],f=Object(a.useState)(),b=Object(d.a)(f,2),h=b[0],j=b[1],v=function(){var e=Object(Z.a)(X.a.mark((function e(){return X.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,ht.publishPost({content:u});case 3:j(null),l(""),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),j(e.t0.message);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}(),g=Object(r.jsxs)("div",{children:[Object(r.jsx)(U.a,{children:Object(r.jsx)(yt.a,{})}),Object(r.jsxs)(U.a,{alignItems:"center",display:"flex",height:n.sav3.topBar.height,children:[Object(r.jsx)(U.a,{flexGrow:1}),Object(r.jsx)(R.a,{disableElevation:!0,variant:"contained",onClick:v,color:"primary",children:"SAV3"})]})]});return Object(r.jsxs)(U.a,{px:2,display:"flex",children:[Object(r.jsx)(U.a,{pr:1.5,py:1.5,children:Object(r.jsx)(Rt.a,{src:i.thumbnailUrl,className:t.avatar})}),Object(r.jsxs)(U.a,{pt:1,width:"100%",children:[Object(r.jsx)($.a,{className:t.content,onChange:function(e){var t=e.target.value;try{t.length>140&&(t=t.subtring(0,140)),l(t)}catch(n){}},margin:"dense",id:"content",placeholder:e["Uncensorable content"](),fullWidth:!0,multiline:!0,variant:"outlined",value:u}),h&&Object(r.jsx)(U.a,{py:1,children:Object(r.jsx)(jt.a,{classes:{message:t.errorMessage},severity:"error",children:h})}),g]})]})},ba=function(){var e=Object(a.useContext)(Un),t=e.following,n=e.setAllFollowing;return[Object.keys(t).filter((function(e){return!!t[e]})),n]},ha=n(568),ja=n.n(ha),va=function(e){var t=e.toString();return{has:function(e){return!!localStorage.getItem("".concat(t,"-").concat(e))},get:function(e){return JSON.parse(localStorage.getItem("".concat(t,"-").concat(e)))},set:function(e,n){Object(Z.a)(X.a.mark((function r(){return X.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,n.data;case 2:n.data=r.sent,localStorage.setItem("".concat(t,"-").concat(e),JSON.stringify(n));case 4:case"end":return r.stop()}}),r)})))()},delete:function(e){localStorage.removeItem("".concat(t,"-").concat(e))},clear:function(){throw Error("localStorageMemoize.clear() not implemented")}}},ga=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=va(e);return ja()(e,Object(ee.a)(Object(ee.a)({},t),{},{cache:n}))},xa=n(88),Oa=n.n(xa),ma=function(){var e=Object(Z.a)(X.a.mark((function e(){var t;return X.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,ya();case 3:return t=e.sent,e.abrupt("return",t);case 7:return e.prev=7,e.t0=e.catch(0),console.error(e.t0),e.abrupt("return",[]);case 11:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}(),ya=ga(function(){var e=Object(Z.a)(X.a.mark((function e(){var t,n,r,a,s,i;return X.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=Ye.a.bootstrapUsersGoogleSheetId,de()(t&&"string"===typeof t,"fetchBootstrapUsersCidsFromGoogleSheet invalid google sheet id '".concat(t,"'")),r=[],e.prev=3,e.next=6,fetch("https://docs.google.com/spreadsheets/d/".concat(t,"/export?format=csv"));case 6:return n=e.sent,e.next=9,n.text();case 9:n=(n=e.sent).split("\n"),a=Object(te.a)(n);try{for(a.s();!(s=a.n()).done;)i=s.value,Oa.a.cid(i.trim())&&r.push(i.trim())}catch(c){a.e(c)}finally{a.f()}e.next=18;break;case 15:throw e.prev=15,e.t0=e.catch(3),Error("failed fetching bootstrap users from google sheet '".concat(t,"' response '").concat(n,"': ").concat(e.t0.message));case 18:return e.abrupt("return",r);case 19:case"end":return e.stop()}}),e,null,[[3,15]])})));return function(){return e.apply(this,arguments)}}(),{maxAge:36e5}),wa={getBootstrapUsersCids:ma},Ca=xe()("sav3:hooks:following:use-bootstrap-users-cids"),ka=function(){var e=Object(a.useState)([]),t=Object(d.a)(e,2),n=t[0],r=t[1];return Ca({bootstrapUsersCids:n}),Object(a.useEffect)((function(){Object(Z.a)(X.a.mark((function e(){var t;return X.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,wa.getBootstrapUsersCids();case 2:t=e.sent,r(t);case 4:case"end":return e.stop()}}),e)})))()}),[]),n},Pa=xe()("sav3:hooks:use-users-following"),Sa={},Ia=function(e,t){e=new Set(e);var n,r=Object(te.a)(t);try{for(r.s();!(n=r.n()).done;){var a=n.value;e.add(a)}}catch(s){r.e(s)}finally{r.f()}return Object(Y.a)(e)},Na=function(e){de()(Array.isArray(e),"invalid userCids '".concat(JSON.stringify(e),"'"));var t=new Set(e),n=JSON.stringify(Object(Y.a)(t)),r=Object(a.useState)([]),s=Object(d.a)(r,2),i=s[0],c=s[1];return Pa({userCids:e,usersFollowing:i}),Object(a.useEffect)((function(){var e,n=Object(te.a)(t);try{var r=function(){var t=e.value,n=Sa[t];n?c((function(e){return Ia(e,n)})):ht.getUserFollowing(t).then((function(e){Sa[t]=e,c((function(t){return Ia(t,e)}))}))};for(n.s();!(e=n.n()).done;)r()}catch(a){n.e(a)}finally{n.f()}}),[n]),i},Fa=xe()("sav3:hooks:use-users-post-cids"),Ra=function(e){var t,n={},r=Object(te.a)(e);try{for(r.s();!(t=r.n()).done;){n[t.value]=[]}}catch(a){r.e(a)}finally{r.f()}return n},Ua=function(e){de()(Array.isArray(e),"invalid userCids '".concat(JSON.stringify(e),"'"));var t=_r(e),n=new Set(e),r=Object(a.useState)(Ra(e)),s=Object(d.a)(r,2),i=s[0],c=s[1],o=zr(t);Fa({userCids:e,usersIpnsContents:t,previousUsersIpnsContents:o,usersPostCids:i});return Object(a.useEffect)((function(){!function(){var t,r=[],a=[],s=Object(te.a)(e);try{for(s.s();!(t=s.n()).done;){var o=t.value;i[o]||r.push(o)}}catch(l){s.e(l)}finally{s.f()}for(var u in i)n.has(u)||a.push(u);(r.length||a.length)&&c((function(e){var t,n=Object(ee.a)({},e),s=Object(te.a)(r);try{for(s.s();!(t=s.n()).done;){var i=t.value;n[i]||(n[i]=[])}}catch(l){s.e(l)}finally{s.f()}var c,o=Object(te.a)(a);try{for(o.s();!(c=o.n()).done;)delete n[c.value]}catch(l){o.e(l)}finally{o.f()}return n}))}();var r=function(e){var n=t[e]&&t[e].lastPostCid,r=o&&o[e]&&o[e].lastPostCid;if(!n||n===r)return"continue";var a=20;Object(Z.a)(X.a.mark((function t(){var r,s,o,u,l,p,d,f;return X.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:r=!0,s=!1,t.prev=2,u=function(){var t=d;return i[e].includes(t)?"continue":(c((function(n){return(n=JSON.parse(JSON.stringify(n)))[e]=[].concat(Object(Y.a)(n[e]),[t]),n})),a--?void 0:{v:void 0})},l=Object(We.a)(ht.getPreviousPostCids(n));case 5:return t.next=7,l.next();case 7:return p=t.sent,r=p.done,t.next=11,p.value;case 11:if(d=t.sent,r){t.next=21;break}if("continue"!==(f=u())){t.next=16;break}return t.abrupt("continue",18);case 16:if("object"!==typeof f){t.next=18;break}return t.abrupt("return",f.v);case 18:r=!0,t.next=5;break;case 21:t.next=27;break;case 23:t.prev=23,t.t0=t.catch(2),s=!0,o=t.t0;case 27:if(t.prev=27,t.prev=28,r||null==l.return){t.next=32;break}return t.next=32,l.return();case 32:if(t.prev=32,!s){t.next=35;break}throw o;case 35:return t.finish(32);case 36:return t.finish(27);case 37:case"end":return t.stop()}}),t,null,[[2,23,27,37],[28,,32,36]])})))()};for(var a in t)r(a)}),[JSON.stringify(t)]),i},Ba=xe()("sav3:hooks:feed:feed-provider"),Aa=Object(a.createContext)(),Ja=function(e){var t=new Set;for(var n in e){var r,a=Object(te.a)(e[n]);try{for(a.s();!(r=a.n()).done;){var s=r.value;de()(s&&"string"===typeof s,"FeedProvider invalid postCid '".concat(s,"' in '").concat(JSON.stringify(e),"'")),t.add(s)}}catch(i){a.e(i)}finally{a.f()}}return Object(Y.a)(t)},Ma=function(e){var t=new Set;for(var n in e)e[n]&&e[n].userCid&&t.add(e[n].userCid);return Object(Y.a)(t)},Ta=function(e,t){var n,r=[],a=Object(te.a)(t);try{for(a.s();!(n=a.n()).done;){var s=n.value;if(e[s]){var i,c=Object(te.a)(e[s]);try{for(c.s();!(i=c.n()).done;){var o=i.value;r.push(o)}}catch(u){c.e(u)}finally{c.f()}}}}catch(u){a.e(u)}finally{a.f()}return r},za=function(e){var t=Ft(),n=ba(),a=Object(d.a)(n,1)[0],s=ka(),i=Na([].concat(Object(Y.a)(a),Object(Y.a)(s))),c=new Set([].concat(Object(Y.a)(a),Object(Y.a)(s),Object(Y.a)(i)));t&&c.add(t);var o=Object(Y.a)(c),u=Ua(o),l=Ta(u,a),p=Ta(u,o),f=Ja(u),b=qr(f),h=Ma(b),j=Object(Y.a)(new Set([].concat(Object(Y.a)(o),Object(Y.a)(h)))),v=Hr(j);Ba({ownCid:t,followingCids:a,bootstrapUsersCids:s,followingOfFollowingCids:i,usersPostCids:u,posts:b,profiles:v,feedPostCids:l,homePostCids:p});var g={posts:b,profiles:v,feedPostCids:l,homePostCids:p},x=e.children;return Object(r.jsx)(Aa.Provider,{value:g,children:x})},Ea=xe()("sav3:hooks:feed:use-home-posts"),Wa=function(){var e,t=Object(a.useContext)(Aa),n=t.posts,r=t.profiles,s=t.homePostCids,i=Object(a.useState)(10),c=Object(d.a)(i,2),o=c[0],u=c[1],l=Object(a.useState)([]),p=Object(d.a)(l,2),f=p[0],b=p[1],h=[],j=Object(te.a)(s);try{for(j.s();!(e=j.n()).done;){var v=e.value;n[v]&&h.push(n[v])}}catch(N){j.e(N)}finally{j.f()}var g=h.length>f.length;Object(a.useEffect)((function(){if(!(f.length>=o)&&!(h.length<=f.length)){var e=h.filter((function(e){var t,n=Object(te.a)(f);try{for(n.s();!(t=n.n()).done;){if(t.value.cid===e.cid)return!1}}catch(N){n.e(N)}finally{n.f()}return!0})).sort((function(e,t){return t.timestamp-e.timestamp}));b((function(t){var n,r=JSON.parse(JSON.stringify(t)),a=Object(te.a)(e);try{for(a.s();!(n=a.n()).done;){var s=n.value;if(r.length>=o)break;r.push(s)}}catch(N){a.e(N)}finally{a.f()}return r}))}}),[o,JSON.stringify(h),JSON.stringify(r)]);var x,O=JSON.parse(JSON.stringify(f)),m=Object(te.a)(O);try{for(m.s();!(x=m.n()).done;){var y=x.value;y.profile=r[y.userCid]||{}}}catch(N){m.e(N)}finally{m.f()}var w,C=Object(te.a)(O);try{for(C.s();!(w=C.n()).done;){var k=w.value;k.parentPost=n[k.parentPostCid],k.parentPost&&(k.parentPost.profile=r[k.parentPost.userCid]||{})}}catch(N){C.e(N)}finally{C.f()}var P,S=Object(te.a)(O);try{for(S.s();!(P=S.n()).done;){var I=P.value;I.quotedPost=n[I.quotedPostCid],I.quotedPost&&(I.quotedPost.profile=r[I.quotedPost.userCid]||{})}}catch(N){S.e(N)}finally{S.f()}return Ea({homePosts:f,postsWithAllData:O,postCount:o,posts:n,hasMore:g}),{posts:O,next:function(){u((function(e){return e+10}))},hasMore:g,reset:function(){u(10),b([])}}},La=xe()("sav3:views:home");var qa=function(){var e=Object(p.a)(),t=Object(wt.a)(e.breakpoints.down("xs")),n=V(),a=Wa(),s=a.posts,i=a.next,c=a.hasMore;La({posts:s});var o=Object(r.jsx)(Fr,{posts:s,next:i,hasMore:c});return s.length||(o=Object(r.jsxs)(U.a,{width:"100%",py:4,display:"flex",justifyContent:"center",alignItems:"center",children:[Object(r.jsx)(Nr.a,{size:24}),Object(r.jsx)(U.a,{p:.5}),Object(r.jsx)(Ut.a,{variant:"body1",children:n["Connecting to peers"]()+"..."})]})),Object(r.jsxs)("div",{children:[Object(r.jsxs)(un,{children:[t&&Object(r.jsx)(U.a,{pl:2,pr:1,children:Object(r.jsx)(pa,{})}),Object(r.jsx)(U.a,{pl:2,children:Object(r.jsx)(Ut.a,{noWrap:!0,variant:"h6",children:n.Home()})})]}),!t&&Object(r.jsxs)("div",{children:[Object(r.jsxs)(U.a,{pb:1,children:[Object(r.jsx)(fa,{}),Object(r.jsx)(yt.a,{})]}),Object(r.jsx)(yt.a,{})]}),o]})},Da=function(){var e=Object(a.useState)([]),t=Object(d.a)(e,2),n=t[0],r=t[1];return Object(a.useEffect)((function(){Object(Z.a)(X.a.mark((function e(){var t;return X.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Rn.getAllFollowing();case 2:t=e.sent,r(t);case 4:case"end":return e.stop()}}),e)})))()}),[]),n},Ka=xe()("sav3:hooks:feed:use-feed-posts"),_a=function(){var e,t=Object(a.useContext)(Aa),n=t.posts,r=t.profiles,s=t.feedPostCids,i=Object(a.useState)(10),c=Object(d.a)(i,2),o=c[0],u=c[1],l=Object(a.useState)([]),p=Object(d.a)(l,2),f=p[0],b=p[1],h=[],j=Object(te.a)(s);try{for(j.s();!(e=j.n()).done;){var v=e.value;n[v]&&h.push(n[v])}}catch(N){j.e(N)}finally{j.f()}var g=h.length>f.length;Object(a.useEffect)((function(){if(!(f.length>=o)&&!(h.length<=f.length)){var e=h.filter((function(e){var t,n=Object(te.a)(f);try{for(n.s();!(t=n.n()).done;){if(t.value.cid===e.cid)return!1}}catch(N){n.e(N)}finally{n.f()}return!0})).sort((function(e,t){return t.timestamp-e.timestamp}));b((function(t){var n,r=JSON.parse(JSON.stringify(t)),a=Object(te.a)(e);try{for(a.s();!(n=a.n()).done;){var s=n.value;if(r.length>=o)break;r.push(s)}}catch(N){a.e(N)}finally{a.f()}return r}))}}),[o,JSON.stringify(h),JSON.stringify(r)]);var x,O=JSON.parse(JSON.stringify(f)),m=Object(te.a)(O);try{for(m.s();!(x=m.n()).done;){var y=x.value;y.profile=r[y.userCid]||{}}}catch(N){m.e(N)}finally{m.f()}var w,C=Object(te.a)(O);try{for(C.s();!(w=C.n()).done;){var k=w.value;k.parentPost=n[k.parentPostCid],k.parentPost&&(k.parentPost.profile=r[k.parentPost.userCid]||{})}}catch(N){C.e(N)}finally{C.f()}var P,S=Object(te.a)(O);try{for(S.s();!(P=S.n()).done;){var I=P.value;I.quotedPost=n[I.quotedPostCid],I.quotedPost&&(I.quotedPost.profile=r[I.quotedPost.userCid]||{})}}catch(N){S.e(N)}finally{S.f()}return Ka({feedPosts:f,postsWithAllData:O,postCount:o,posts:n,hasMore:g}),{posts:O,next:function(){u((function(e){return e+10}))},hasMore:g,reset:function(){u(10),b([])}}},Qa=xe()("sav3:views:feed");var Ha=function(){var e=Object(p.a)(),t=Object(wt.a)(e.breakpoints.down("xs")),n=V(),a=Da(),s=_a(),i=s.posts,c=s.next,o=s.hasMore;Qa({posts:i});var u=Object(r.jsx)(Fr,{posts:i,next:c,hasMore:o});return i.length||(u=Object(r.jsxs)(U.a,{width:"100%",py:4,display:"flex",justifyContent:"center",alignItems:"center",children:[Object(r.jsx)(Nr.a,{size:24}),Object(r.jsx)(U.a,{p:.5}),Object(r.jsx)(Ut.a,{variant:"body1",children:n["Connecting to peers"]()+"..."})]})),i.length||a.length||(u=Object(r.jsx)(U.a,{width:"100%",py:4,display:"flex",justifyContent:"center",alignItems:"center",children:Object(r.jsx)(Ut.a,{variant:"body1",children:n["Not following anyone"]()+"..."})})),Object(r.jsxs)("div",{children:[Object(r.jsxs)(un,{children:[t&&Object(r.jsx)(U.a,{pl:2,pr:1,children:Object(r.jsx)(pa,{})}),Object(r.jsx)(U.a,{pl:2,children:Object(r.jsx)(Ut.a,{noWrap:!0,variant:"h6",children:n.Feed()})})]}),!t&&Object(r.jsxs)("div",{children:[Object(r.jsxs)(U.a,{pb:1,children:[Object(r.jsx)(fa,{}),Object(r.jsx)(yt.a,{})]}),Object(r.jsx)(yt.a,{})]}),u]})},Va=n(1408),Ga=Object(l.a)((function(e){return{search:{height:e.sav3.topBar.height/1.5,"& fieldset":{border:"none",backgroundColor:e.palette.divider}}}}));var Xa=function(){var e=Ga(),t=Object(p.a)(),n=Object(wt.a)(t.breakpoints.down("xs")),s=Object(a.useState)(""),i=Object(d.a)(s,2),c=i[0],o=i[1],u=V();return Object(r.jsxs)("div",{children:[Object(r.jsxs)(un,{children:[Object(r.jsx)(U.a,{pl:n?2:4,children:n&&Object(r.jsx)(U.a,{pr:.5,children:Object(r.jsx)(pa,{})})}),Object(r.jsx)(U.a,{width:"100%",pl:0,pr:4,children:Object(r.jsx)($.a,{onChange:function(e){var t=e.target.value;try{t=t.trim(),o(t)}catch(n){}},InputProps:{spellCheck:!1,classes:{root:e.search},startAdornment:Object(r.jsx)(U.a,{pr:1,children:Object(r.jsx)(Va.a,{position:"start",children:Object(r.jsx)(y.a,{})})})},variant:"outlined",fullWidth:!0,placeholder:u["Search user ID"](),value:c})})]}),Oa.a.cid(c)&&Object(r.jsx)(ra,{userCid:c})]})},Za=function(){var e=Object(a.useState)([]),t=Object(d.a)(e,2),n=t[0],r=t[1],s=Object(a.useState)(0),i=Object(d.a)(s,2),c=i[0],o=i[1];return Object(a.useEffect)((function(){setInterval((function(){o(c+1)}),2e3)}),[]),Object(a.useEffect)((function(){Object(Z.a)(X.a.mark((function e(){var t;return X.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ht.getPeersCids();case 2:t=e.sent,r(t);case 4:case"end":return e.stop()}}),e)})))()}),[c]),n},$a=xe()("sav3:hooks:use-users-posts"),Ya=function(e){de()(Array.isArray(e),"invalid userCids '".concat(JSON.stringify(e),"'"));var t=Object(a.useState)([]),n=Object(d.a)(t,2),r=n[0],s=n[1],i=_r(e),c=Hr(e),o=[];for(var u in i)o.push(i[u].lastPostCid);return $a({usersIpnsContents:i,userCids:e,lastPostCids:o,usersPosts:r,profiles:c}),Object(a.useEffect)((function(){if(o.length){var e,t=Object(te.a)(o);try{for(t.s();!(e=t.n()).done;){var n=e.value;n&&"string"===typeof n&&ht.getUserPostsFromLastPostCid(n).then((function(e){var t,n={},r=Object(te.a)(e);try{for(r.s();!(t=r.n()).done;){var a=t.value;a.profile=c[a.userCid]||{},n[a.cid]=a}}catch(i){r.e(i)}finally{r.f()}s((function(e){return Object(ee.a)(Object(ee.a)({},e),n)}))}))}}catch(a){t.e(a)}finally{t.f()}}else r.length&&s([])}),[JSON.stringify(o),JSON.stringify(c)]),r},es=xe()("sav3:views:peers");var ts=function(){var e=Object(p.a)(),t=Object(wt.a)(e.breakpoints.down("xs")),n=V(),a=Object(o.f)(),s=Za(),i=Ft();i&&(s=[i].concat(Object(Y.a)(s)));var c=Ya(s),u=[];for(var l in c)u.push(c[l]);es({peersCids:s,posts:u,postsObject:c});var d=Object(r.jsx)(Fr,{posts:u});return u.length||(d=Object(r.jsxs)(U.a,{width:"100%",py:4,display:"flex",justifyContent:"center",alignItems:"center",children:[Object(r.jsx)(Nr.a,{size:24}),Object(r.jsx)(U.a,{p:.5}),Object(r.jsx)(Ut.a,{variant:"body1",children:n["Connecting to peers"]()+"..."})]})),Object(r.jsxs)("div",{children:[Object(r.jsxs)(un,{children:[Object(r.jsx)(U.a,{pr:1,children:Object(r.jsx)(mt.a,{onClick:function(){return a.goBack()},children:Object(r.jsx)(pn.a,{})})}),Object(r.jsx)(Ut.a,{noWrap:!0,variant:"h6",children:n["Connected peers posts"]()})]}),!t&&Object(r.jsxs)("div",{children:[Object(r.jsxs)(U.a,{pb:1,children:[Object(r.jsx)(fa,{}),Object(r.jsx)(yt.a,{})]}),Object(r.jsx)(yt.a,{})]}),d]})},ns=new Set,rs=ve({name:"ipIsoCountryCodeCache",maxSize:2e3}),as=function(){var e=Object(Z.a)(X.a.mark((function e(t){var n;return X.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,rs.get(t);case 2:if(!(n=e.sent)){e.next=5;break}return e.abrupt("return",n);case 5:throw ns.has(t)||(ns.add(t),ss(t).then((function(e){return rs.set(t,e)})).catch((function(e){return console.error(e)}))),Error("iso country code for ip '".concat(t,"' not cached yet"));case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ss=function(){var e=Object(Z.a)(X.a.mark((function e(t){var n,r,a;return X.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return de()("string"===typeof t,"invalid ip '".concat(t,"' not a string")),n="https://ipapi.co/".concat(t,"/country/"),e.prev=2,e.next=5,fetch(n);case 5:return a=e.sent,e.next=8,a.text();case 8:a=e.sent,r=a.trim().toUpperCase(),is(r),e.next=17;break;case 13:throw e.prev=13,e.t0=e.catch(2),e.t0.message="failed getting country iso code from '".concat(n,"' response '").concat(a,"': ").concat(e.t0.message),e.t0;case 17:return e.abrupt("return",r);case 18:case"end":return e.stop()}}),e,null,[[2,13]])})));return function(t){return e.apply(this,arguments)}}(),is=function(e){var t=typeof e;de()(/^[a-z]{2}$/i.test(e),"isoCountryCode must be an ISO 3166-1 alpha-2 string, but got '".concat("string"===t?e:t,"' instead"))},cs={getIsoCountryCodeFromIpCached:as,getIsoCountryCodeFromIp:ss,getIsoCountryCodesFromIps:function(e){var t,n=[],r=Object(te.a)(e);try{for(r.s();!(t=r.n()).done;){var a=t.value;n.push(ss(a))}}catch(s){r.e(s)}finally{r.f()}return Promise.all(n)},isoCountryCodeToCountryFlagEmoji:function(e){is(e);var t=Object(Y.a)(e.toUpperCase()).map((function(e){return e.charCodeAt()+127397}));return String.fromCodePoint.apply(String,Object(Y.a)(t))}},os=xe()("sav3:hooks:use-peers-stats"),us=function(){var e=Object(a.useState)([]),t=Object(d.a)(e,2),n=t[0],r=t[1],s=Object(a.useState)(0),i=Object(d.a)(s,2),c=i[0],o=i[1];return Object(a.useEffect)((function(){setInterval((function(){o(c+1)}),5e3)}),[]),Object(a.useEffect)((function(){Object(Z.a)(X.a.mark((function e(){var t,n,a,s,i,c;return X.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ht.getPeersStats();case 2:t=e.sent,n=Object(te.a)(t),e.prev=4,n.s();case 6:if((a=n.n()).done){e.next=26;break}if((s=a.value).ip){e.next=10;break}return e.abrupt("continue",24);case 10:return i=void 0,e.prev=11,e.next=14,cs.getIsoCountryCodeFromIpCached(s.ip);case 14:i=e.sent,e.next=21;break;case 17:return e.prev=17,e.t0=e.catch(11),os(e.t0.message),e.abrupt("continue",24);case 21:c=cs.isoCountryCodeToCountryFlagEmoji(i),s.isoCountryCode=i,s.countryFlagEmoji=c;case 24:e.next=6;break;case 26:e.next=31;break;case 28:e.prev=28,e.t1=e.catch(4),n.e(e.t1);case 31:return e.prev=31,n.f(),e.finish(31);case 34:r(t);case 35:case"end":return e.stop()}}),e,null,[[4,28,31,34],[11,17]])})))()}),[c]),n},ls=n(369),ps=n.n(ls),ds=Object(l.a)((function(e){return{avatar:{marginTop:e.spacing(-.25),width:e.spacing(6),height:e.spacing(6),borderWidth:e.sav3.borderWidth,borderStyle:"solid",borderColor:e.sav3.borderColor,backgroundColor:e.palette.background.default},userCid:{wordBreak:"break-all"}}}));var fs=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.peer,n=ds();return Object(r.jsx)("div",{children:Object(r.jsxs)(U.a,{px:2,py:1.5,display:"flex",children:[Object(r.jsx)(U.a,{pr:1.5,children:Object(r.jsx)(Rt.a,{className:n.avatar,children:t.countryFlagEmoji})}),Object(r.jsxs)(U.a,{width:"100%",children:[Object(r.jsxs)(U.a,{display:"flex",children:[Object(r.jsxs)(U.a,{flexGrow:1,children:[Object(r.jsx)(U.a,{display:"flex",children:Object(r.jsxs)(Ut.a,{variant:"subtitle2",children:[t.ip,":",t.port]})}),Object(r.jsx)(U.a,{children:Object(r.jsx)(Ut.a,{variant:"caption",color:"textSecondary",className:n.userCid,children:t.peerCid})})]}),Object(r.jsx)(U.a,{height:48})]}),Object(r.jsxs)(Ut.a,{variant:"body2",children:["\u2b06\ufe0f",ps()(t.dataSent),"\xa0\xa0\u2b07\ufe0f",ps()(t.dataReceived)]})]})]})})},bs=xe()("sav3:views:stats");function hs(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.peers,n=V();if(!t.length)return Object(r.jsxs)(U.a,{width:"100%",py:4,display:"flex",justifyContent:"center",alignItems:"center",children:[Object(r.jsx)(Nr.a,{size:24}),Object(r.jsx)(U.a,{p:.5}),Object(r.jsx)(Ut.a,{variant:"body1",children:n["Connecting to peers"]()+"..."})]});var a,s=[],i=Object(te.a)(t);try{for(i.s();!(a=i.n()).done;){var c=a.value;s.push(Object(r.jsx)(fs,{peer:c},c.peerCid+c.port)),s.push(Object(r.jsx)(yt.a,{},c.peerCid+c.port+"feed divider"))}}catch(o){i.e(o)}finally{i.f()}return Object(r.jsx)("div",{children:s})}var js=function(){var e=V(),t=Object(o.f)(),n=us();return bs({peers:n}),Object(r.jsxs)("div",{children:[Object(r.jsxs)(un,{children:[Object(r.jsx)(U.a,{pr:1,children:Object(r.jsx)(mt.a,{onClick:function(){return t.goBack()},children:Object(r.jsx)(pn.a,{})})}),Object(r.jsx)(Ut.a,{noWrap:!0,variant:"h6",children:e["Connected peers stats"]()})]}),Object(r.jsx)(hs,{peers:n})]})},vs=Object(l.a)((function(e){return{avatar:{marginTop:e.spacing(-.25),width:e.spacing(6),height:e.spacing(6),borderWidth:e.sav3.borderWidth,borderStyle:"solid",borderColor:e.sav3.borderColor},userCid:{wordBreak:"break-all",textDecoration:"inherit"},displayName:{color:"inherit",textDecoration:"inherit"}}}));var gs=function(e){return de()("string"===typeof e,"forceHttps link '".concat(e,"' not a string")),e=(e=e.trim()).replace(/^http:\/\//,"https://")},xs=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.user,n=vs(),a=V(),s=An(t.cid),i=Object(d.a)(s,2),c=i[0],o=i[1],u=Object(r.jsx)(R.a,{variant:"outlined",size:"small",color:"primary",onClick:function(){return o(!0)},children:a.Follow()});c&&(u=Object(r.jsx)(R.a,{variant:"outlined",size:"small",color:"primary",onClick:function(){return o(!1)},children:a.Unfollow()}));var l=Yn(t.cid),p="/profile/".concat(l);return Object(r.jsx)("div",{children:Object(r.jsxs)(U.a,{px:2,py:1.5,display:"flex",children:[Object(r.jsx)(U.a,{pr:1.5,children:Object(r.jsx)(Rt.a,{component:M.b,to:p,src:t.thumbnailUrl&&gs(t.thumbnailUrl),className:n.avatar})}),Object(r.jsxs)(U.a,{width:"100%",children:[Object(r.jsxs)(U.a,{display:"flex",children:[Object(r.jsxs)(U.a,{flexGrow:1,children:[Object(r.jsx)(U.a,{display:"flex",children:Object(r.jsx)(Ut.a,{className:n.displayName,component:M.b,to:p,variant:"subtitle2",children:t.displayName})}),Object(r.jsx)(U.a,{children:Object(r.jsx)(Ut.a,{component:M.b,to:p,variant:"caption",color:"textSecondary",className:n.userCid,children:t.cid})})]}),Object(r.jsx)(U.a,{height:48,children:u})]}),Object(r.jsx)(Ut.a,{variant:"body2",children:t.description})]})]})})};var Os=function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.users,a=[],s=Object(te.a)(n);try{for(s.s();!(e=s.n()).done;){var i=e.value;a.push(Object(r.jsx)(xs,{user:i},i.cid)),a.push(Object(r.jsx)(yt.a,{},i.cid+"feed divider"))}}catch(c){s.e(c)}finally{s.f()}return Object(r.jsx)("div",{children:a})},ms=xe()("sav3:views:following");var ys=function(){var e,t=V(),n=Object(o.f)(),a=Da(),s=Hr(a),i=[],c=Object(te.a)(a);try{for(c.s();!(e=c.n()).done;){var u=e.value,l=s[u]||{};l.cid=u,i.push(l)}}catch(d){c.e(d)}finally{c.f()}var p=Object(r.jsx)(Os,{users:i});return i.length||(p=Object(r.jsx)(U.a,{width:"100%",py:4,display:"flex",justifyContent:"center",alignItems:"center",children:Object(r.jsx)(Ut.a,{variant:"body1",children:t["Not following anyone"]()+"..."})})),ms({followingCids:a,profiles:s,users:i}),Object(r.jsxs)("div",{children:[Object(r.jsxs)(un,{children:[Object(r.jsx)(U.a,{pr:1,children:Object(r.jsx)(mt.a,{onClick:function(){return n.goBack()},children:Object(r.jsx)(pn.a,{})})}),Object(r.jsx)(Ut.a,{noWrap:!0,variant:"h6",children:t.Following()})]}),p]})},ws=Object(l.a)((function(e){return{message:{overflow:"hidden"},data:{"& textarea":{fontFamily:"Monospace",minHeight:"10vh",maxHeight:"40vh",overflowY:"scroll!important"},"& fieldset":{border:"none"},"& .MuiInputBase-root":{paddingLeft:0,paddingRight:0},marginBottom:e.spacing(1)}}}));var Cs=function(){var e=V(),t=ws(),n=Object(p.a)(),s=ba(),i=Object(d.a)(s,2)[1],c=Object(a.useState)(""),o=Object(d.a)(c,2),u=o[0],l=o[1],f=Object(a.useState)(),b=Object(d.a)(f,2),h=b[0],j=b[1],v=Object(a.useState)(),g=Object(d.a)(v,2),x=g[0],O=g[1],m=function(e){try{e.target.setSelectionRange(0,e.target.value.length)}catch(t){}},y=function(){var e=Object(Z.a)(X.a.mark((function e(){var t,n,r;return X.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return l("Exporting..."),j(null),O(null),e.prev=3,e.next=6,Rn.getAllFollowing();case 6:return t=e.sent,e.next=9,ht.getPrivateKey();case 9:n=e.sent,r=JSON.stringify({privateKey:n,following:t}),j(null),l(r),e.next=18;break;case 15:e.prev=15,e.t0=e.catch(3),j(e.t0.message);case 18:O("Export successful. Copy paste your data somewhere safe.");case 19:case"end":return e.stop()}}),e,null,[[3,15]])})));return function(){return e.apply(this,arguments)}}(),w=function(){var e=Object(Z.a)(X.a.mark((function e(){var t,n;return X.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:j(null),O(null),e.prev=2,t=JSON.parse(u),e.next=10;break;case 6:return e.prev=6,e.t0=e.catch(2),j("Invalid JSON: ".concat(e.t0.message)),e.abrupt("return");case 10:if(h===(n="Did you backup your data? Importing will irreversibly delete it. Click import again to confirm.")){e.next=14;break}return j(n),e.abrupt("return");case 14:return e.prev=14,e.next=17,Rn.setAllFollowing(t.following);case 17:i(t.following),e.next=24;break;case 20:return e.prev=20,e.t1=e.catch(14),j("Invalid following: ".concat(e.t1.message)),e.abrupt("return");case 24:return e.prev=24,e.next=27,Rn.setAllFollowing(t.following);case 27:i(t.following),e.next=34;break;case 30:return e.prev=30,e.t2=e.catch(24),j("Invalid privateKey: ".concat(e.t2.message)),e.abrupt("return");case 34:j(null),O("Import successful.");case 36:case"end":return e.stop()}}),e,null,[[2,6],[14,20],[24,30]])})));return function(){return e.apply(this,arguments)}}(),C=Object(r.jsxs)("div",{children:[Object(r.jsx)(U.a,{children:Object(r.jsx)(yt.a,{})}),Object(r.jsxs)(U.a,{alignItems:"center",display:"flex",height:n.sav3.topBar.height,children:[Object(r.jsx)(U.a,{flexGrow:1}),Object(r.jsx)(R.a,{disableElevation:!0,variant:"contained",onClick:w,color:"primary",children:e.Import()}),Object(r.jsx)(U.a,{pr:.5}),Object(r.jsx)(R.a,{disableElevation:!0,variant:"contained",onClick:y,color:"primary",children:e.Export()})]})]});return Object(r.jsx)(U.a,{px:2,display:"flex",children:Object(r.jsxs)(U.a,{pt:0,width:"100%",children:[Object(r.jsx)($.a,{onClick:m,onFocus:m,className:t.data,onChange:function(e){var t=e.target.value;l(t)},margin:"dense",id:"data",placeholder:"Paste exported data here...",fullWidth:!0,multiline:!0,variant:"outlined",value:u}),h&&Object(r.jsx)(U.a,{pb:1,children:Object(r.jsx)(jt.a,{classes:{message:t.message},severity:"error",children:h})}),x&&Object(r.jsx)(U.a,{pb:1,children:Object(r.jsx)(jt.a,{classes:{message:t.message},severity:"success",children:x})}),Object(r.jsx)(U.a,{pb:0}),C]})})};var ks=function(){var e=Object(p.a)(),t=Object(wt.a)(e.breakpoints.down("xs")),n=V();return Object(r.jsxs)("div",{children:[Object(r.jsxs)(un,{children:[t&&Object(r.jsx)(U.a,{pl:2,pr:1,children:Object(r.jsx)(pa,{})}),Object(r.jsx)(U.a,{pl:2,children:Object(r.jsxs)(Ut.a,{noWrap:!0,variant:"h6",children:[n.Import()," / ",n.Export()]})})]}),Object(r.jsx)(Cs,{})]})},Ps=xe()("sav3:hooks:use-post-with-replies"),Ss=function(e){de()(!e||"string"===typeof e,"invalid postCid '".concat(JSON.stringify(e),"'"));var t,n=Object(a.useState)(),r=Object(d.a)(n,2),s=r[0],i=r[1],c=rr(s&&s.cid),o=qr(c),u={},l=Object(te.a)(c);try{for(l.s();!(t=l.n()).done;){var p=t.value;u[p]=o[p]}}catch(f){l.e(f)}finally{l.f()}if(Object(a.useEffect)((function(){s&&i(),e&&"string"===typeof e&&Object(Z.a)(X.a.mark((function t(){var n,r,a;return X.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,ht.getPost(e);case 2:if(n=t.sent,r=n,!n.parentPostCid){t.next=8;break}return t.next=7,ht.getPost(n.parentPostCid);case 7:r=t.sent;case 8:i(r),(a=r.quotedPostCid)&&ht.getPost(a).then((function(e){return i((function(t){return Object(ee.a)(Object(ee.a)({},t),{},{quotedPost:e})}))}));case 11:case"end":return t.stop()}}),t)})))()}),[e]),Ps({parentPost:s,replyCids:c,replies:u}),s)return Object(ee.a)(Object(ee.a)({},s),{},{replies:u})},Is=xe()("sav3:hooks:use-parent-posts-with-profiles"),Ns=function(e){var t=new Set;if(Array.isArray(e)){var n,r=Object(te.a)(e);try{for(r.s();!(n=r.n()).done;){var a=n.value;a&&a.parentPostCid&&t.add(a.parentPostCid)}}catch(i){r.e(i)}finally{r.f()}}else for(var s in e)e[s]&&e[s].parentPostCid&&t.add(e[s].parentPostCid);return Object(Y.a)(t)},Fs=function(e){var t=new Set;for(var n in e)e[n]&&e[n].userCid&&t.add(e[n].userCid);return Object(Y.a)(t)},Rs=function(e){de()(e&&"object"===typeof e,"invalid postsObjectOrArray '".concat(JSON.stringify(e),"'"));var t=Ns(e),n=qr(t),r=Fs(n),a=Hr(r),s={};for(var i in n)s[i]=Object(ee.a)({},n[i]),s[i].profile=a[s[i].userCid]||{};return Is({parentPostCids:t,parentPosts:n,profiles:a,userCids:r,parentPostsWithProfiles:s,postsObjectOrArray:e}),s},Us=xe()("sav3:views:post");var Bs=function(){var e,t=Object(o.h)().encodedCid,n=t&&er(t);!n&&t&&(e=$n(t));var a=Ss(e),s=Rs(a?[a]:[]),i=Object(o.f)(),c=V(),u=[];if(a)for(var l in u.push(a),a.replies)a.replies[l]&&u.push(a.replies[l]);u.length>1&&(u[0]=Object(ee.a)(Object(ee.a)({},u[0]),{},{isParent:!0})),s[u[0]&&u[0].parentPostCid]&&(u[0]=Object(ee.a)(Object(ee.a)({},u[0]),{},{parentPost:s[u[0].parentPostCid]}));for(var p=new Set,d=0,f=u;d<f.length;d++){var b=f[d];p.add(b.userCid)}for(var h=Hr(Object(Y.a)(p)),j=0,v=u;j<v.length;j++){var g=v[j];g.profile=h[g.userCid]||{}}var x=Object(r.jsx)(Fr,{posts:u});return u.length||(x=Object(r.jsxs)(U.a,{width:"100%",py:4,display:"flex",justifyContent:"center",alignItems:"center",children:[Object(r.jsx)(Nr.a,{size:24}),Object(r.jsx)(U.a,{p:.5}),Object(r.jsx)(Ut.a,{variant:"body1",children:c["Connecting to peers"]()+"..."})]})),n&&(x=Object(r.jsx)(U.a,{width:"100%",py:4,display:"flex",justifyContent:"center",alignItems:"center",children:Object(r.jsx)(Ut.a,{variant:"body1",children:c["URL expired"]()+"."})})),Us({postCid:e,postWithReplies:a,posts:u}),Object(r.jsxs)("div",{children:[Object(r.jsxs)(un,{children:[Object(r.jsx)(U.a,{pr:1,children:Object(r.jsx)(mt.a,{onClick:function(){return i.goBack()},children:Object(r.jsx)(pn.a,{})})}),Object(r.jsx)(Ut.a,{noWrap:!0,variant:"h6",children:c.Post()})]}),x]})},As=Object(l.a)((function(e){var t,n,r;return{leftColumn:(t={overflow:"hidden"},Object(c.a)(t,e.breakpoints.down("xs"),{display:"none"}),Object(c.a)(t,e.breakpoints.down("md"),{width:e.sav3.layout.columns.left.width.xs}),Object(c.a)(t,e.breakpoints.down("lg"),{width:e.sav3.layout.columns.left.width.xs}),Object(c.a)(t,e.breakpoints.up("lg"),{width:e.sav3.layout.columns.left.width.md}),t),middleColumn:(n={overflow:"hidden"},Object(c.a)(n,e.breakpoints.down("xs"),{width:"100%"}),Object(c.a)(n,e.breakpoints.up("xs"),{width:e.sav3.layout.columns.middle.width.md}),Object(c.a)(n,"borderLeftWidth",e.sav3.borderWidth),Object(c.a)(n,"borderRightWidth",e.sav3.borderWidth),Object(c.a)(n,"borderTopWidth",0),Object(c.a)(n,"borderBottomWidth",0),Object(c.a)(n,"borderStyle","solid"),Object(c.a)(n,"borderColor",e.sav3.borderColor),n),rightColumn:(r={overflow:"hidden"},Object(c.a)(r,e.breakpoints.down("sm"),{display:"none"}),Object(c.a)(r,e.breakpoints.down("lg"),{width:e.sav3.layout.columns.right.width.md,paddingLeft:e.spacing(3),paddingRight:e.spacing(3)}),Object(c.a)(r,e.breakpoints.up("lg"),{width:e.sav3.layout.columns.right.width.lg,paddingLeft:e.spacing(4),paddingRight:e.spacing(4)}),r),bottomMenu:Object(c.a)({},e.breakpoints.up("sm"),{display:"none"}),appBar:{backgroundColor:e.palette.background.default}}}));var Js=function(){var e=As(),t=Object(p.a)();return window.theme=t,Object(r.jsxs)("div",{children:[Object(r.jsxs)(u.a,{container:!0,justify:"center",children:[Object(r.jsx)(u.a,{item:!0,className:e.leftColumn,children:Object(r.jsx)(zt,{})}),Object(r.jsx)(u.a,{item:!0,className:e.middleColumn,children:Object(r.jsxs)(o.c,{children:[Object(r.jsx)(o.a,{path:"/",exact:!0,children:Object(r.jsx)(qa,{})}),Object(r.jsx)(o.a,{path:"/feed",exact:!0,children:Object(r.jsx)(Ha,{})}),Object(r.jsx)(o.a,{path:"/profile/:encodedCid?",exact:!0,children:Object(r.jsx)(sa,{})}),Object(r.jsx)(o.a,{path:"/search",exact:!0,children:Object(r.jsx)(Xa,{})}),Object(r.jsx)(o.a,{path:"/peers",exact:!0,children:Object(r.jsx)(ts,{})}),Object(r.jsx)(o.a,{path:"/stats",exact:!0,children:Object(r.jsx)(js,{})}),Object(r.jsx)(o.a,{path:"/following",exact:!0,children:Object(r.jsx)(ys,{})}),Object(r.jsx)(o.a,{path:"/export",exact:!0,children:Object(r.jsx)(ks,{})}),Object(r.jsx)(o.a,{path:"/post/:encodedCid",exact:!0,children:Object(r.jsx)(Bs,{})})]})}),Object(r.jsxs)(u.a,{item:!0,className:e.rightColumn,children:[Object(r.jsx)(rn,{}),Object(r.jsx)(an,{})]})]}),Object(r.jsx)(Dt,{className:e.bottomMenu})]})},Ms=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,1421)).then((function(t){var n=t.getCLS,r=t.getFID,a=t.getFCP,s=t.getLCP,i=t.getTTFB;n(e),r(e),a(e),s(e),i(e)}))},Ts=n(1410);i.a.render(Object(r.jsx)(M.a,{children:Object(r.jsx)(en,{children:Object(r.jsx)(H,{children:Object(r.jsx)(Bn,{children:Object(r.jsxs)(za,{children:[Object(r.jsx)(Ts.a,{}),Object(r.jsx)(Js,{})]})})})})}),document.getElementById("root")),Ms()},285:function(e,t){},342:function(e,t){},559:function(e,t,n){"use strict";(function(e){var r=n(366),a=n(15),s=n(1),i=n.n(s),c=n(8),o=n(125),u=n(99),l=n(250),p=n(269),d=n(7),f=n.n(d),b=n(364),h=n.n(b),j=n(45),v=n.n(j),g=n(87),x=n.n(g),O=n(59),m=n.n(O),y=n(173),w=n.n(y),C=n(31),k=n.n(C),P=n(28),S=n.n(P),I=n(88),N=n.n(I),F=n(254),R=n.n(F),U=n(126),B=n(25),A=n.n(B)()("sav3:sav3-ipfs:ipns-client"),J=function(t){Object(l.a)(r,t);var n=Object(p.a)(r);function r(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=t.ipfs;return Object(o.a)(this,r),e=n.call(this),f()(a&&"object"===typeof a),e.ipfs=a,e.privateKey=null,e.webSocketClient=null,e.peerCid=null,e.url=U.a.ipnsServer,e.subscriptionIpnsValueCache=new R.a({maxSize:1e4}),e.start(),e}return Object(u.a)(r,[{key:"start",value:function(){var e=Object(c.a)(i.a.mark((function e(){var t,n=this;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return f()(null===this.webSocketClient),this.webSocketClient=h()(this.url),e.next=4,this.ipfs.key.export("self","password");case 4:return t=e.sent,e.next=7,x.a.keys.import(t,"password");case 7:return this.privateKey=e.sent,e.next=10,this.ipfs.id();case 10:this.peerCid=e.sent.id,this.webSocketClient.on("publish",function(){var e=Object(c.a)(i.a.mark((function e(t,r){var a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,z(t,r);case 2:a=e.sent,n.subscriptionIpnsValueCache.set(t,a),n.emit("publish",t,a);case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}());case 12:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"stop",value:function(){var e=Object(c.a)(i.a.mark((function e(){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.webSocketClient.close();case 2:this.webSocketClient=null;case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"isReady",value:function(){return this.webSocketClient&&this.privateKey}},{key:"waitForReady",value:function(){var e=Object(c.a)(i.a.mark((function e(){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.isReady()){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,w()(10);case 4:return e.next=6,this.waitForReady();case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"subscribe",value:function(){var e=Object(c.a)(i.a.mark((function e(t){var n,r,s,c,o,u,l,p,d,f=this;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return M(t),e.next=3,this.waitForReady();case 3:n=!0,r=[],s=Object(a.a)(t);try{for(s.s();!(c=s.n()).done;)o=c.value,u=this.subscriptionIpnsValueCache.get(o),r.push(u),u||(n=!1)}catch(i){s.e(i)}finally{s.f()}if(!n){e.next=10;break}return A("subscribe",{allResultsAreCached:n,ipnsPaths:t,cachedIpnsValues:r}),e.abrupt("return",r);case 10:return e.next=12,new Promise((function(e){return f.webSocketClient.emit("subscribe",t,e)}));case 12:return l=e.sent,e.next=15,T(t,l);case 15:for(d in p=e.sent,t)this.subscriptionIpnsValueCache.set(t[d],p[d]);return A("subscribe",{allResultsAreCached:n,ipnsPaths:t,ipnsValues:p}),e.abrupt("return",p);case 19:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getRecords",value:function(){var e=Object(c.a)(i.a.mark((function e(t){var n,r,a=this;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return M(t),e.next=3,this.waitForReady();case 3:return e.next=5,new Promise((function(e){return a.webSocketClient.emit("resolve",t,e)}));case 5:return n=e.sent,e.next=8,E(t,n);case 8:return r=e.sent,e.abrupt("return",r);case 10:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"unsubscribe",value:function(){var e=Object(c.a)(i.a.mark((function e(t){var n,r,s;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return M(t),e.next=3,this.waitForReady();case 3:n=Object(a.a)(t);try{for(n.s();!(r=n.n()).done;)s=r.value,this.subscriptionIpnsValueCache.delete(s)}catch(i){n.e(i)}finally{n.f()}return e.next=7,this.webSocketClient.emit("unsubscribe",t);case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"publish",value:function(){var t=Object(c.a)(i.a.mark((function t(){var n,r,a,s,c,o,u,l=arguments;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=l.length>0&&void 0!==l[0]?l[0]:{},r=n.value,a=n.sequence,f()("string"===typeof r),f()("number"===typeof a),t.next=5,this.waitForReady();case 5:return r.startsWith("/ipfs/")||(r="/ipfs/".concat(r)),s=31536e7,t.next=9,m.a.create(this.privateKey,r,a,s);case 9:return c=t.sent,t.next=12,m.a.embedPublicKey(this.privateKey.public,c);case 12:return o=e.from(m.a.marshal(c)),u=this.peerCid,t.next=16,this.webSocketClient.emit("publish",u,o);case 16:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()}]),r}(v.a),M=function(e){f()(Array.isArray(e),"ipns paths '".concat(JSON.stringify(e),"' not an array"));var t,n=Object(a.a)(e);try{for(n.s();!(t=n.n()).done;){var r=t.value;f()("string"===typeof r,"ipns paths '".concat(JSON.stringify(e),"' contains non string '").concat(r,"'"))}}catch(s){n.e(s)}finally{n.f()}},T=function(){var e=Object(c.a)(i.a.mark((function e(t,n){var r,a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:f()(Array.isArray(t)),f()(Array.isArray(n)),r=[],e.t0=i.a.keys(t);case 4:if((e.t1=e.t0()).done){e.next=16;break}if(a=e.t1.value,null!==n[a]){e.next=9;break}return r.push(null),e.abrupt("continue",4);case 9:return e.t2=r,e.next=12,z(t[a],n[a]);case 12:e.t3=e.sent,e.t2.push.call(e.t2,e.t3),e.next=4;break;case 16:return e.abrupt("return",r);case 17:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),z=function(){var e=Object(c.a)(i.a.mark((function e(t,n){var r,a,s,c;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return f()("string"===typeof t),n=new Uint8Array(n),r=m.a.unmarshal(n),a=m.a.extractPublicKey({},r),e.next=6,m.a.validate(a,r);case 6:return e.next=8,S.a.createFromPubKey(a.bytes);case 8:return s=e.sent,f()(s.equals(S.a.createFromB58String(t))),c=k()(r.value),f()(N.a.cid(c.replace(/^\/ipfs\//,""))),e.abrupt("return",c);case 13:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),E=function(){var e=Object(c.a)(i.a.mark((function e(t,n){var r,a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:f()(Array.isArray(t)),f()(Array.isArray(n)),r=[],e.t0=i.a.keys(t);case 4:if((e.t1=e.t0()).done){e.next=16;break}if(a=e.t1.value,null!==n[a]){e.next=9;break}return r.push(null),e.abrupt("continue",4);case 9:return e.t2=r,e.next=12,W(t[a],n[a]);case 12:e.t3=e.sent,e.t2.push.call(e.t2,e.t3),e.next=4;break;case 16:return e.abrupt("return",r);case 17:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),W=function(){var e=Object(c.a)(i.a.mark((function e(t,n){var r,a,s,c;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return f()("string"===typeof t),n=new Uint8Array(n),r=m.a.unmarshal(n),a=m.a.extractPublicKey({},r),e.next=6,m.a.validate(a,r);case 6:return e.next=8,S.a.createFromPubKey(a.bytes);case 8:return s=e.sent,f()(s.equals(S.a.createFromB58String(t))),c=k()(r.value),f()(N.a.cid(c.replace(/^\/ipfs\//,""))),e.abrupt("return",r);case 13:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}();window.IpnsClient=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return Object(r.a)(J,t)},window.ipns=m.a,t.a=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return Object(r.a)(J,t)}}).call(this,n(24).Buffer)},601:function(e,t){},608:function(e,t){},682:function(e,t){},683:function(e,t){},783:function(e,t){},785:function(e,t){},841:function(e,t){},907:function(e,t){},909:function(e,t){}},[[1344,1,2]]]);
//# sourceMappingURL=main.7ed6c713.chunk.js.map